[{"path":"/articles/inequantiles-intro.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Introduction to inequantiles: Quantile-Based Inequality Measures for Survey Data","text":"inequantiles package provides tools estimating quantiles quantile-based economic inequality indicators survey data, full support complex sampling designs. core inequantiles package quantile ratio index (QRI), indicator provides comprehensive robust measure inequality considering entire distribution. Unlike Gini coefficient, highly sensitive large values long tails, QRI based solely quantiles, making remarkably resistant anomalous observations high skewness, even small samples. package offers comprehensive methods : Quantile ratio index (QRI): Estimation superpopulations, complex survey data,grouped data, variance estimation via rescaled bootstrap Traditional quantile-based indicators: Quintile share ratio (QSR), Palma ratio, percentile ratios (e.g., P90/P10), flexible quantile estimator selection Weighted quantile estimation: Multiple interpolation rules (types 4-9 plus HD) complex sampling data Linearization techniques: Influence function QRI, QSR, Gini coefficient quantiles Grouped data support: Estimation quantiles, QRI Gini coefficient frequency tables grouped data microdata unavailable (e.g., fiscal data) functions demonstrated using synthetic survey data included package.","code":""},{"path":"/articles/inequantiles-intro.html","id":"installation","dir":"Articles","previous_headings":"Overview","what":"Installation","title":"Introduction to inequantiles: Quantile-Based Inequality Measures for Survey Data","text":"","code":"# Install from GitHub devtools::install_github(\"silviascarpa/inequantiles\") library(inequantiles)"},{"path":"/articles/inequantiles-intro.html","id":"import-synthetic-survey-data","dir":"Articles","previous_headings":"Overview","what":"Import synthetic survey data","title":"Introduction to inequantiles: Quantile-Based Inequality Measures for Survey Data","text":"dataset synthhouse synthetically generated mimic tipical survey dataset like Italian EU-SILC. contains basic information individual household level, including equivalized disposable income.","code":"data(synthouse) head(synthouse) #>    person_id    hh_id NUTS1 NUTS2   NUTS3 municipality age age_class gender #> 1 HH000001P1 HH000001     N   N01  N01005   N010050010  39     35-49      1 #> 2 HH000001P2 HH000001     N   N01  N01005   N010050010  38     35-49      2 #> 3 HH000001P3 HH000001     N   N01  N01005   N010050010  15     15-17      1 #> 4 HH000001P4 HH000001     N   N01  N01005   N010050010  13      0-14      2 #> 5 HH000002P1 HH000002    NE  NE06 NE06004  NE060040007  37     35-49      2 #> 6 HH000003P1 HH000003     N   N05  N05003   N050030007  54     50-64      2 #>   education_level employment_status hh_size hh_type eq_income hh_income #> 1             Low          Employed       4  Family  10430.70  23990.61 #> 2          Medium          Employed       4  Family  10430.70  23990.61 #> 3            <NA>           Student       4  Family  10430.70  23990.61 #> 4            <NA>           Student       4  Family  10430.70  23990.61 #> 5          Medium          Employed       1  Single  36588.27  36588.27 #> 6             Low          Employed       2  Couple  13390.50  20085.75 #>   oecd_scale     weight #> 1        2.3   83.66134 #> 2        2.3   83.66134 #> 3        2.3   83.66134 #> 4        2.3   83.66134 #> 5        1.0  167.24423 #> 6        1.5 1419.28854"},{"path":[]},{"path":"/articles/inequantiles-intro.html","id":"the-quantile-ratio-index-qri","dir":"Articles","previous_headings":"Theoretical Background","what":"The Quantile Ratio Index (QRI)","title":"Introduction to inequantiles: Quantile-Based Inequality Measures for Survey Data","text":"QRI introduced Prendergast Staudte (2018) simple, effective inequality measure. QRI: Considers entire distribution Depends solely quantiles robust extreme values require choosing specific percentiles continuous random variable YY cdf F(y)F(y) quantile function Q(p)=F‚àí1(p)Q(p) = F^{-1}(p), define ratio symmetric quantiles : R(p)=Q(p/2)Q(1‚àíp/2),p‚àà(0,1).R(p) = \\frac{Q(p/2)}{Q(1-p/2)}, \\quad p \\(0,1). QRI defined : QRI=1‚àí‚à´01R(p)dp=1‚àí‚à´01Q(p/2)Q(1‚àíp/2)dp.\\text{QRI} = 1 - \\int_0^1 R(p) \\, dp = 1 - \\int_0^1 \\frac{Q(p/2)}{Q(1-p/2)} \\, dp. QRI ranges 0 (perfect equality) 1 (maximum inequality). measures area equi-distribution line (R(p)=1R(p) = 1 pp) actual inequality curve. can easily visualised:  theoretical parametric distributions known quantile functions, can compute exact QRI: Consider finite population U={1,‚Ä¶,N}U = \\{1, \\ldots, N\\}, random sample ss size nn selected. Let yjy_j, j‚ààsj \\s, observed values variable interest, y(1),‚Ä¶,y(n)y_{(1)}, \\ldots, y_{(n)} denoting order statistics. Assume sample drawn according certain sampling scheme, inclusion probability œÄj=Pr(j‚ààs)\\pi_j = Pr(j \\s). corresponding sampling weight wjw_j obtained inversion inclusion probability, plus, required, adjustments non-response calibration. Let Wj=‚àë‚ààswiùüè(‚â§j)W_j = \\sum_{\\s} w_i \\mathbf{1}(\\leq j) denote cumulative sum weights ordered observation jj. Let QÃÇ(p)\\widehat{Q}(p) pp quantile estimator. survey data finite population, Scarpa, Ferrante, Sperlich (2025) approximate QRI integral using grid MM points QRIÃÇ=1M‚àëm=1M(1‚àíQÃÇ(pm/2)QÃÇ(1‚àípm/2)) \\widehat{\\text{QRI}} = \\frac{1}{M} \\sum_{m=1}^M \\left(1 - \\frac{\\widehat{Q}(p_m/2)}{\\widehat{Q}(1-p_m/2)}\\right) pm=(m‚àí0.5)/Mp_m = (m-0.5)/M. default, M=100M = 100. QRIÃÇ\\widehat{\\text{QRI}} strictly sensitive choice quantile estimator, especially small samples.","code":"library(ggplot2) n <- 1000 prob_grid <- seq(0, 1, length.out = n + 2)  # Compute R(p) for different distributions comp_R <- function(probs, qfunction, ...) {   ifelse(probs == 0 | probs == 1,           c(0, 1)[match(probs, c(0, 1))],          qfunction(probs/2, ...) / qfunction(1 - probs/2, ...)) }  # Crea il dataframe Rs_data <- data.frame(   p = rep(prob_grid, 4),   R = c(     comp_R(prob_grid, qlnorm, meanlog = 9, sdlog = 0.3),     comp_R(prob_grid, qlnorm, meanlog = 9, sdlog = 0.6),     comp_R(prob_grid, qlnorm, meanlog = 9, sdlog = 0.9),     comp_R(prob_grid, qlnorm, meanlog = 9, sdlog = 1.2)   ),   Distribution = rep(c(\"LogN(9, 0.3)\", \"LogN(9, 0.6)\",                         \"LogN(9, 0.9)\", \"LogN(9, 1.2)\"),                       each = length(prob_grid)) )  # Plot ggplot(Rs_data, aes(x = p, y = R, color = Distribution, linetype = Distribution)) +   geom_line(linewidth = 0.9) +   geom_hline(yintercept = 1, linewidth = 1, color = \"black\") +   scale_x_continuous(name = \"p\", expand = c(0, 0)) +   scale_y_continuous(name = \"R(p)\", expand = c(0, 0)) +   scale_color_brewer(palette = \"Set2\") +   theme_bw() +   theme(     axis.title = element_text(size = 16),     axis.text = element_text(size = 14),     legend.text = element_text(size = 14),     legend.title = element_blank(),     legend.position = \"bottom\"   ) # Log-normal distribution superpop_qri(qfunction = qlnorm, meanlog = 9, sdlog = 0.3) #> [1] 0.3433188 superpop_qri(qfunction = qlnorm, meanlog = 9, sdlog = 0.7) #> [1] 0.5696547 superpop_qri(qfunction = qlnorm, meanlog = 9, sdlog = 1.2) #> [1] 0.7079337  # Weibull distribution superpop_qri(qfunction = qweibull, shape = 2, scale = 30000) #> [1] 0.522862 superpop_qri(qfunction = qweibull, shape = 1.5, scale = 30000) #> [1] 0.6003122"},{"path":"/articles/inequantiles-intro.html","id":"quantile-estimators","dir":"Articles","previous_headings":"Theoretical Background","what":"Quantile estimators","title":"Introduction to inequantiles: Quantile-Based Inequality Measures for Survey Data","text":"pp quantile estimator can expressed weighted average order statistics, QÃÇ(p)=y(k‚àí1)+(y(k)‚àíy(k‚àí1))(p‚àírÃÇk‚àí1rÃÇk‚àírÃÇk‚àí1), \\widehat{Q}(p)=y_{(k-1)}+ \\left(y_{(k )} - y_{(k- 1)}\\right) \\left(\\frac{p - \\widehat{r}_{k - 1 }}{\\widehat{r}_{k} - \\widehat{r}_{k - 1}} \\right), \\label{eq:quantiles complessi} rÃÇk\\widehat{r}_{k} indicates estimator cdf, namely plotting position, selected order kk Wk‚àí1‚àímk‚àí1<Wnp<Wk‚àímkW_{k-1} - m_{k-1} < W_n p < W_{k} - m_k, mkm_k determined interpolation method adjacent data points. Linear interpolation points (rÃÇ,y(k))(\\widehat r, y_{(k)}) gives quantile estimator complex sampling data. p=0p=0 p=1p=1, define QÃÇ(0)=y(1)\\widehat{Q} (0)=y_{(1)} QÃÇ(1)=y(n)\\widehat{Q}(1)=y_{(n)}. Quantile estimators incorporating sampling weights. extension Harrell-Davis estimator survey data also provided, QÃÇHD(p)=‚àëj‚ààsùí≤ÃÇj(p)Y(j)\\widehat{Q}_{HD}(p)=\\sum_{j \\s} \\widehat{\\mathcal{W}}_{j}(p) Y_{(j)}, ùí≤ÃÇj(p)=b(Wj/Wn){(Wn+wn)p,Wn‚àí(Wn+wn)p+wn}‚àíb(Wj‚àí1/Wn){(Wn+wn)p,Wn‚àí(Wn+wn)p+wn} \\begin{aligned} \\widehat{\\mathcal{W}}_{j}(p) = & \\, b_{(W_{j} / W_n)}\\{(W_n+ w_n) p, W_n - (W_n+ w_n)p + w_n\\} \\\\ & - b_{(W_{j - 1}/ W_n)}\\{(W_n+ w_n) p, W_n - (W_n+ w_n)p + w_n\\} \\end{aligned}","code":""},{"path":"/articles/inequantiles-intro.html","id":"example-computing-weighted-quantiles","dir":"Articles","previous_headings":"Theoretical Background > Quantile estimators","what":"Example: Computing Weighted Quantiles","title":"Introduction to inequantiles: Quantile-Based Inequality Measures for Survey Data","text":"Differences among quantle estimators particularly evident small samples distribution tails:","code":"# Compute weighted quartiles csquantile(y = synthouse$eq_income,            weights = synthouse$weight,            probs = c(0.25, 0.5, 0.75),            type = 6) #>      25%      50%      75%  #> 12353.29 20014.17 32222.93  # Compare with unweighted csquantile(synthouse$eq_income, probs = c(0.25, 0.5, 0.75), type = 6) #>      25%      50%      75%  #> 12910.48 20429.20 32529.02 # Harrell-Davis weighted median csquantile(y = synthouse$eq_income,            weights = synthouse$weight,            probs = 0.5,            type = \"HD\") #>      50%  #> 20017.37 # Compare different quantile types by NUTS3 types <- c(4, 5, 6, 7, 8, 9, \"HD\") areas <- unique(synthouse$NUTS3)  # Function to compute QRI for all types in one area compare_quantiles <- function(region_code, data = synthouse) {   idx <- which(data$NUTS3 == region_code)      results <- sapply(types, function(t) {     csquantile(y = data$eq_income[idx],          weights = data$weight[idx],          type = t,         probs = 0.95)   })      return(results) }  # Compute for all areas results_quantiles <- sapply(areas, compare_quantiles) rownames(results_quantiles) <- types colnames(results_quantiles) <- areas  # Convert to readable data frame results_df_quantiles <- as.data.frame(t(results_quantiles)) results_df_quantiles <- round(results_df_quantiles, 4) results_df_quantiles <- cbind(NUTS3 = rownames(results_df_quantiles), results_df_quantiles) rownames(results_df_quantiles) <- NULL  print(\"=== Quantile estimators for Each NUTS3 Region ===\") #> [1] \"=== Quantile estimators for Each NUTS3 Region ===\" print(head(results_df_quantiles, n = 10)) #>      NUTS3        4        5        6        7        8        9       HD #> 1   N01005 70988.83 75538.32 87604.07 69761.89 80343.39 79093.40 76388.02 #> 2  NE06004 50988.47 50988.47 50988.47 50992.05 50988.47 50988.47 50988.47 #> 3   N05003 81116.08 82948.72 81211.01 83560.96 82496.53 82633.53 81370.54 #> 4  NE06002 47742.34 47749.81 47749.81 47749.81 47749.81 47749.81 47749.81 #> 5   N02004 52599.79 53137.63 52644.75 53559.00 52883.63 52956.29 52818.39 #> 6  NO02004 66674.78 66674.78 67773.72 61032.04 66904.21 66771.79 66674.78 #> 7  NO03002 67724.83 71393.13 71459.35 71351.81 71411.51 71406.64 72491.41 #> 8   N06004 45313.69 45317.87 45313.69 45706.20 45313.69 45313.69 45313.69 #> 9  NE02004 57268.49 57299.09 57303.00 57297.80 57299.86 57299.64 57279.50 #> 10  S04005 58411.94 62602.84 60288.65 62670.74 61561.74 61786.33 62670.69"},{"path":"/articles/inequantiles-intro.html","id":"example-qri-estimator","dir":"Articles","previous_headings":"Theoretical Background","what":"Example: QRI estimator","title":"Introduction to inequantiles: Quantile-Based Inequality Measures for Survey Data","text":"sample drawn simple random sampling design, QRI can easily estimated Real survey data, instead, typically includes sampling weights. package supports multiple quantile estimation methods (types 4-9 Harrell-Davis) quantile-based inequality indicators estimators. Differences evident small samples:","code":"# Generate a simple random sample of income data (log-normal distribution) set.seed(123) income <- rlnorm(500, meanlog = 9, sdlog = 0.7)   # Compute QRI qri(income) #> [1] 0.5580828 # Compute weighted QRI qri(y = synthouse$eq_income,      weights = synthouse$weight,      type = 6)  # Type 6 quantile estimator (default) #> [1] 0.5690895 # Compare different quantile types by NUTS3 types <- c(4, 5, 6, 7, 8, 9, \"HD\") areas <- unique(synthouse$NUTS3)  # Function to compute QRI for all types in one area compare_qri <- function(region_code, data = synthouse) {   idx <- which(data$NUTS3 == region_code)      results <- sapply(types, function(t) {     qri(y = data$eq_income[idx],          weights = data$weight[idx],          type = t)   })      return(results) }  # Compute for all areas results_qri <- sapply(areas, compare_qri) rownames(results_qri) <- types colnames(results_qri) <- areas  # Convert to readable data frame results_df_qri <- as.data.frame(t(results_qri)) results_df_qri <- round(results_df_qri, 4) results_df_qri <- cbind(NUTS3 = rownames(results_df_qri), results_df_qri) rownames(results_df_qri) <- NULL  print(\"=== QRI by Quantile Type for Each NUTS3 Region ===\") #> [1] \"=== QRI by Quantile Type for Each NUTS3 Region ===\" print(head(results_df_qri, n = 10)) #>      NUTS3      4      5      6      7      8      9     HD #> 1   N01005 0.5950 0.5943 0.5963 0.5930 0.5949 0.5948 0.5937 #> 2  NE06004 0.6028 0.6030 0.6035 0.6023 0.6032 0.6031 0.6021 #> 3   N05003 0.5797 0.5818 0.5806 0.5824 0.5815 0.5816 0.5811 #> 4  NE06002 0.4633 0.4641 0.4638 0.4647 0.4641 0.4641 0.4642 #> 5   N02004 0.4772 0.4758 0.4776 0.4745 0.4763 0.4762 0.4762 #> 6  NO02004 0.5150 0.5130 0.5163 0.5097 0.5143 0.5139 0.5127 #> 7  NO03002 0.5633 0.5622 0.5664 0.5583 0.5635 0.5632 0.5619 #> 8   N06004 0.6270 0.6261 0.6278 0.6246 0.6267 0.6265 0.6254 #> 9  NE02004 0.6158 0.6148 0.6166 0.6132 0.6154 0.6153 0.6161 #> 10  S04005 0.5889 0.5895 0.5894 0.5894 0.5895 0.5895 0.5891"},{"path":"/articles/inequantiles-intro.html","id":"qri-estimator-sampling-variance","dir":"Articles","previous_headings":"Theoretical Background","what":"QRI estimator sampling variance","title":"Introduction to inequantiles: Quantile-Based Inequality Measures for Survey Data","text":"complex surveys, rescaled bootstrap method (Rao Wu 1988; Rao, Wu, Yue 1992) recommended estimation QRI estimator sampling variance, demonstrated Scarpa, Ferrante, Sperlich (2025):","code":"# Pseudo-code for rescaled bootstrap for the estimation of the sampling variance of the QRI estimator var_qri <- rescaled_bootstrap(   data = synthouse,   y = \"eq_income\",   strata = \"NUTS2\",   psu = \"municipality\",   weights = \"weight\",   estimator = function(x, w) qri(y = x, weights = w, type = 6),   by_strata = TRUE,   B = 100,   seed = 456)"},{"path":[]},{"path":"/articles/inequantiles-intro.html","id":"quintile-share-ratio-qsr","dir":"Articles","previous_headings":"Other Inequality Indicators","what":"Quintile Share Ratio (QSR)","title":"Introduction to inequantiles: Quantile-Based Inequality Measures for Survey Data","text":"QSR compares income share top 20% bottom 20%. estimator defined QSRÃÇ=‚àëj‚ààswjyjùüè{yj‚â•QÃÇ(0.8)}‚àëj‚ààswjyjùüè{yj‚â§QÃÇ(0.2)}. \\widehat{{QSR}} = \\frac{\\sum_{j \\s}w_j y_j \\mathbf{1}\\left\\{ y_j \\geq \\widehat{Q}(0.8)\\right\\} }{\\sum_{j \\s} w_j y_j\\mathbf{1}\\left\\{ y_j \\leq \\widehat{Q}(0.2)\\right\\} } \\ .","code":"# Compute QSR qsr(y = synthouse$eq_income,      weights = synthouse$weight, type = 4) #> [1] 7.023932"},{"path":"/articles/inequantiles-intro.html","id":"palma-ratio","dir":"Articles","previous_headings":"Other Inequality Indicators","what":"Palma Ratio","title":"Introduction to inequantiles: Quantile-Based Inequality Measures for Survey Data","text":"Palma ratio compares top 10% bottom 40% aggregated income: PalmaÃÇ=‚àëj‚ààswjyjùüè{yj‚â•QÃÇ(0.9)}‚àëj‚ààswjyjùüè{yj‚â§QÃÇ(0.4)}. \\widehat{{Palma}} = \\frac{\\sum_{j \\s}w_j y_j \\mathbf{1}\\left\\{ y_j \\geq \\widehat{Q}(0.9)\\right\\} }{\\sum_{j \\s} w_j y_j\\mathbf{1}\\left\\{ y_j \\leq \\widehat{Q}(0.4)\\right\\} } \\ .","code":"# Compute Palma ratio palma_ratio(y = synthouse$eq_income,              weights = synthouse$weight, type = 7) #> [1] 1.578482"},{"path":"/articles/inequantiles-intro.html","id":"percentile-ratios","dir":"Articles","previous_headings":"Other Inequality Indicators","what":"Percentile Ratios","title":"Introduction to inequantiles: Quantile-Based Inequality Measures for Survey Data","text":"often National Statistical Offices measure inequality using ratios percentiles, example: P90/P10ÃÇ=QÃÇ(p=0.9)QÃÇ(p=0.1) \\widehat{{P}90/{P}10} = \\frac{\\widehat{Q}(p=0.9)}{\\widehat{Q}(p=0.1)}","code":"# P90/P10 ratio ratio_quantiles(y = synthouse$eq_income,                 weights = synthouse$weight,                 prob_numerator = 0.90,                 prob_denominator = 0.10,                 type = 7) #> [1] 5.918233  # P75/P25 ratio ratio_quantiles(y = synthouse$eq_income,                 weights = synthouse$weight,                 prob_numerator = 0.75,                 prob_denominator = 0.25, type = 6) #> [1] 2.60845"},{"path":"/articles/inequantiles-intro.html","id":"comparing-indicators-across-groups","dir":"Articles","previous_headings":"","what":"Comparing Indicators Across Groups","title":"Introduction to inequantiles: Quantile-Based Inequality Measures for Survey Data","text":"Multiple inequality indicators exist literature, capturing different aspects income distribution. Different indicators may provide complementary perspectives inequality, researchers choose appropriate measure based specific research questions distributional features interest. common task comparing inequality across geographical areas demographic groups:","code":"# Compare QRI across macro-regions (NUTS1) tapply(seq_len(nrow(synthouse)), synthouse$NUTS1, function(idx) {   qri(y = synthouse$eq_income[idx],       weights = synthouse$weight[idx],       type = 6) }) #>         C         N        NE        NO         S  #> 0.5847404 0.5639082 0.5691184 0.5796789 0.5601799  # Compare multiple indicators compare_regions <- function(region_data, region_weights) {   c(     QRI = qri(region_data, region_weights),     QSR = qsr(region_data, region_weights),     Palma = palma_ratio(region_data, region_weights),     P90_P10 = ratio_quantiles(region_data, region_weights)   ) }  # Apply to each region results_by_region <- tapply(seq_len(nrow(synthouse)),                               synthouse$NUTS1,                               function(idx) {   compare_regions(synthouse$eq_income[idx],                    synthouse$weight[idx]) })  # Display as data frame do.call(rbind, results_by_region) #>          QRI      QSR    Palma  P90_P10 #> C  0.5847404 7.329234 1.629047 6.267395 #> N  0.5639082 6.892276 1.588659 5.595916 #> NE 0.5691184 7.127548 1.624684 5.961529 #> NO 0.5796789 7.746556 1.739012 6.278178 #> S  0.5601799 6.530128 1.455656 5.401721"},{"path":"/articles/inequantiles-intro.html","id":"influence-functions","dir":"Articles","previous_headings":"","what":"Influence Functions","title":"Introduction to inequantiles: Quantile-Based Inequality Measures for Survey Data","text":"package provides influence functions constructing variance estimators using linearization methods measures. quantile estimator influence function () defined Osier (2009) (QÃÇ(p))k=p‚àíùüô(yk‚â§QÃÇ(p))FÃÇ‚Ä≤(QÃÇ(p))N, {}(\\widehat{Q}(p))_{k} = \\frac{p - \\mathbb{1}(y_k \\leq \\widehat{Q}(p)) }{\\widehat{F}'(\\widehat{Q}(p)) N},  FÃÇ‚Ä≤(y)=1NÃÇ1h2œÄ‚àëj‚ààswjexp{‚àí(y‚àíyj)22h2}\\widehat{F}'(y) = \\frac{1}{\\widehat N}\\frac{1}{h \\sqrt{2 \\pi}} \\sum_{j \\s} w_j \\operatorname{exp} \\left\\{-\\frac{(y - y_j)^2}{2h^2} \\right\\}. QSR estimator , demonstrated Langel Till√© (2011), (QSRÃÇ)k=yk‚àí{0.8QÃÇ(0.8)‚àí(QÃÇ(0.8)‚àíyk)ùüè[yk‚â§QÃÇ(0.8)]}YÃÇ0.2‚àí(YÃÇ‚àíYÃÇ0.8){0.2QÃÇ(0.2)‚àí(QÃÇ(0.2)‚àíyk)ùüè[yk‚â§QÃÇ(0.2)]}YÃÇ0.22 (\\widehat{QSR})_{k}=\\frac{y_k-\\left\\{0.8 \\widehat{Q}(0.8)-\\left(\\widehat{Q}(0.8)-y_k\\right) \\mathbf{1}\\left[y_k \\leq \\widehat{Q}(0.8)\\right]\\right\\}}{\\widehat{Y}_{0.2}}-\\frac{\\left(\\widehat{Y}-\\widehat{Y}_{0.8}\\right)\\left\\{0.2 \\widehat{Q}(0.2)-\\left(\\widehat{Q}(0.2)-y_k\\right) \\mathbf{1}\\left[y_k \\leq \\widehat{Q}(0.2)\\right]\\right\\}}{\\widehat{Y}_{0.2}^2} YÃÇŒ±=‚àëj‚ààswjyjùüè[yk‚â§QÃÇ(Œ±)]\\hat{Y}_{\\alpha} = \\sum_{j \\s} w_j y_j \\mathbf{1}[y_k \\leq \\widehat{Q}(\\alpha)]. Scarpa, Ferrante, Sperlich (2025) demonstrated QRI can estimated (QRIÃÇ)k=‚àí‚à´01(p2‚àíùüô(yk‚â§QÃÇ(p/2))FÃÇ‚Ä≤(QÃÇ(p/2))NÃÇ)QÃÇ(1‚àíp/2)‚àí((1‚àíp2)‚àíùüô(yk‚â§QÃÇ(1‚àíp/2))FÃÇ‚Ä≤(QÃÇ(1‚àíp/2))NÃÇ)QÃÇ(p/2)QÃÇ(1‚àíp/2)2dp. {}(\\widehat{QRI})_{k} = - \\int_0^1 \\frac{\\left(\\frac{\\frac{p}{2} - \\mathbb{1}(y_k \\leq \\widehat{Q}(p/2))}{\\widehat{F}'(\\widehat{Q}(p/2))  \\widehat N}\\right) \\widehat{Q}(1-p/2) - \\left(\\frac{(1 - \\frac{p}{2}) - \\mathbb{1}(y_k \\leq \\widehat{Q}(1-p/2))}{\\widehat{F}'(\\widehat{Q}(1-p/2)) \\widehat N}\\right) \\widehat{Q}(p/2)}{ \\widehat{Q}(1-p/2)^2}dp \\ . Gini coefficient can approximated (see Langel Till√© (2013)) (GÃÇ)k=1NÃÇYÃÇ{2Wk(yk‚àíY‚ÄæÃÇk)+YÃÇ‚àíNÃÇyk‚àíGÃÇ(YÃÇ+ykNÃÇ)} {}(\\widehat{G})_{k} =\\frac{1}{\\hat{N} \\hat{Y}}\\left\\{2 W_k\\left(y_k-\\hat{\\bar{Y}}_k\\right)+\\hat{Y}-\\hat{N} y_k-\\hat{G}\\left(\\hat{Y}+y_k \\hat{N}\\right)\\right\\} withYÃÇ=‚àëj‚ààswjyj;Y‚ÄæÃÇj=‚àël‚ààSwlyl1(Wl‚â§Wj)Wk.   \\text{}  \\qquad   \\hat{Y} = \\sum_{j \\s}w_j y_j; \\quad  \\hat{\\bar{Y}}_j=\\frac{\\sum_{l \\S} w_l y_l 1\\left(W_l \\leqslant W_j\\right)}{W_k}.","code":""},{"path":"/articles/inequantiles-intro.html","id":"comparison-of-the-influence-function-values","dir":"Articles","previous_headings":"Influence Functions","what":"Comparison of the influence function values","title":"Introduction to inequantiles: Quantile-Based Inequality Measures for Survey Data","text":"observe Gini Coefficient: - Shows generally increasing pattern income - Less sensitive low incomes QRI: - Balanced influence across entire distribution - Jump around median - robust inequality indicators QSR: - Sharp discontinuities Q(0.2)Q(0.2) Q(0.8)Q(0.8) - Near-zero influence middle 60% distribution - High sensitivity observations boundary quantiles Median: - Step function admits two values - Robust ignores distribution","code":"# Select a subset for clearer visualization n_obs <- 200 set.seed(123) idx <- sample(nrow(synthouse), n_obs)  # Extract data y_subset <- synthouse$eq_income[idx] w_subset <- synthouse$weight[idx]  # Order income values (for ease of representation, see the plots later) order_idx <- order(y_subset) y_ordered <- y_subset[order_idx]      # Order the data w_ordered <- w_subset[order_idx]        # Compute the IF for some indicators if_gini_vals <- if_gini(y_ordered, w_ordered) if_qri_vals <- if_qri(y_ordered, w_ordered, type = 6) if_qsr_vals <- if_qsr(y_ordered, w_ordered, type = 4) if_q50_vals <- if_quantile(y_ordered, w_ordered, probs = 0.5, type = 6) # Create the plot library(ggplot2) library(scales)  #  plot_df <- data.frame(   Income = rep(y_ordered, 4),   IF_Value = c(     if_qri_vals,   # ‚Üê Gi√† ordinato     if_qsr_vals,   # ‚Üê Gi√† ordinato     if_gini_vals,  # ‚Üê Gi√† ordinato     if_q50_vals    # ‚Üê Gi√† ordinato   ),   Indicator = rep(c(\"QRI\", \"QSR\", \"Gini\", \"Median\"), each = n_obs) )  ggplot(plot_df, aes(x = Income, y = IF_Value, color = Indicator)) +   geom_line(linewidth = 0.8, alpha = 0.7) +   geom_hline(yintercept = 0, linetype = \"dashed\", color = \"gray40\") +   facet_wrap(~ Indicator, scales = \"free_y\", ncol = 2) +   scale_x_continuous(labels = scales::comma) +   labs(     title = \"Influence Functions: How Each Observation Affects the Estimate\",     subtitle = paste(\"Based on\", n_obs, \"randomly sampled households\"),     x = \"Equivalized Income (ordered)\",     y = \"Influence Function Value\",     caption = \"Note: Higher absolute values indicate greater influence on the estimate\"   ) +   theme_minimal(base_size = 11) +   theme(     legend.position = \"none\",     strip.text = element_text(face = \"bold\", size = 11),     plot.title = element_text(face = \"bold\", size = 13),     plot.subtitle = element_text(color = \"gray40\"),     panel.grid.minor = element_blank()   )"},{"path":"/articles/inequantiles-intro.html","id":"grouped-data-functions","dir":"Articles","previous_headings":"","what":"Grouped Data Functions","title":"Introduction to inequantiles: Quantile-Based Inequality Measures for Survey Data","text":"frequency tables available (common administrative tax data), package provides specialized functions. Consider grouped data divided L{L} classes known boundaries, observed frequencies f1,‚Ä¶,fL{f_1, \\ldots, f_L} total amounts Y1,‚Ä¶,YL{Y_1, \\ldots, Y_L}. Let:","code":"# Example: Income distribution in frequency table format income_freq <- c(120, 180, 150, 80, 40, 20, 10) income_tot <- c(18800, 16300, 44700, 33900, 21500, 22100, 98300) income_lower <- c(0, 15000, 30000, 45000, 60000, 80000, 100000) income_upper <- c(15000, 30000, 45000, 60000, 80000, 100000, 150000)"},{"path":"/articles/inequantiles-intro.html","id":"quantile-computation-for-grouped-data","dir":"Articles","previous_headings":"Grouped Data Functions","what":"Quantile Computation for Grouped Data","title":"Introduction to inequantiles: Quantile-Based Inequality Measures for Survey Data","text":"quantile class p{p}-th quantile first class l{l} : l=min{l:Cl‚â•pN} {l = min\\{l: C_l \\geq pN \\}} p{p}-th quantile Q(p){Q(p)} estimated linear interpolation within quantile class: Q(p)ÃÉ=Ll+(pN‚àíCl‚àí1)fl‚ãÖhl {\\widetilde{Q(p)} = L_l + \\frac{(pN - C_{l-1})}{f_l} \\cdot h_l}","code":"# Estimate quantiles from grouped data quantile_grouped(freq = income_freq,                  lower_bounds = income_lower,                  upper_bounds = income_upper,                  probs = c(0.25, 0.5, 0.75)) #>  25 %  50 %  75 %  #> 17500 30000 45000"},{"path":"/articles/inequantiles-intro.html","id":"qri-for-grouped-data","dir":"Articles","previous_headings":"Grouped Data Functions","what":"QRI for Grouped Data","title":"Introduction to inequantiles: Quantile-Based Inequality Measures for Survey Data","text":"using quantile measure grouped data, QRI approximated : QRI‚âà1M‚àëm=1M(1‚àíQÃÉ(pm/2)QÃÉ(1‚àípm/2)) {{QRI}} \\approx \\frac{1}{M}\\sum_{m=1}^{M}\\left(1 - \\frac{\\widetilde{Q}(p_m/2)}{\\widetilde{Q}(1 - p_m/2)}\\right)","code":"# Compute QRI from grouped data qri_grouped(freq = income_freq,              lower_bounds = income_lower,              upper_bounds = income_upper,             M = 100) #> [1] 0.5888192"},{"path":"/articles/inequantiles-intro.html","id":"gini-coefficient-from-grouped-data","dir":"Articles","previous_headings":"Grouped Data Functions","what":"Gini coefficient from Grouped Data","title":"Introduction to inequantiles: Quantile-Based Inequality Measures for Survey Data","text":"Gini coefficient approximated linear interpolation cumulative shares, : G‚âà1‚àí‚àël=1L(sl+sl‚àí1)(ul‚àíul‚àí1) {G \\approx 1 - \\sum_{l=1}^{L} (s_l + s_{l-1})(u_l - u_{l-1})}","code":"# Estimate quantiles from grouped data gini_grouped(Y = income_tot, freq = income_freq) #> [1] 0.5787167"},{"path":"/articles/inequantiles-intro.html","id":"handling-open-ended-classes","dir":"Articles","previous_headings":"Grouped Data Functions","what":"Handling Open-Ended Classes","title":"Introduction to inequantiles: Quantile-Based Inequality Measures for Survey Data","text":"functions automatically handle open-ended classes (common tax data):","code":"# Example with open-ended classes wage_freq <- c(150, 200, 180, 220, 180, 50, 15, 5) wage_lower <- c(-Inf, 0, 10000, 15000, 26000, 55000, 75000, 120000) wage_upper <- c(0, 10000, 15000, 26000, 55000, 75000, 120000, Inf)  # Compute QRI (automatically handles infinite bounds) qri_grouped(freq = wage_freq,              lower_bounds = wage_lower,              upper_bounds = wage_upper) #> [1] 0.7268536"},{"path":"/articles/inequantiles-intro.html","id":"getting-help","dir":"Articles","previous_headings":"","what":"Getting Help","title":"Introduction to inequantiles: Quantile-Based Inequality Measures for Survey Data","text":"encounter issues questions: Open issue GitHub Check function documentation: ?qri, ?csquantile, etc. Contact maintainer: silvia.scarpa@unimore.","code":""},{"path":[]},{"path":"/articles/inequantiles-intro.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"Introduction to inequantiles: Quantile-Based Inequality Measures for Survey Data","text":"","code":"sessionInfo() #> R version 4.4.1 (2024-06-14 ucrt) #> Platform: x86_64-w64-mingw32/x64 #> Running under: Windows 11 x64 (build 26200) #>  #> Matrix products: default #>  #>  #> locale: #> [1] LC_COLLATE=Italian_Italy.utf8  LC_CTYPE=Italian_Italy.utf8    #> [3] LC_MONETARY=Italian_Italy.utf8 LC_NUMERIC=C                   #> [5] LC_TIME=Italian_Italy.utf8     #>  #> time zone: Europe/Rome #> tzcode source: internal #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] scales_1.3.0            kableExtra_1.4.0        knitr_1.49              #> [4] ggplot2_3.5.1           inequantiles_0.0.0.9000 #>  #> loaded via a namespace (and not attached): #>  [1] sass_0.4.9         generics_0.1.3     xml2_1.3.6         stringi_1.8.4      #>  [5] digest_0.6.37      magrittr_2.0.3     evaluate_1.0.3     grid_4.4.1         #>  [9] RColorBrewer_1.1-3 fastmap_1.2.0      jsonlite_1.8.9     laeken_0.5.3       #> [13] viridisLite_0.4.2  textshaping_1.0.0  jquerylib_0.1.4    Rdpack_2.6.4       #> [17] cli_3.6.5          rlang_1.1.6        rbibutils_2.4      munsell_0.5.1      #> [21] withr_3.0.2        cachem_1.1.0       yaml_2.3.10        tools_4.4.1        #> [25] dplyr_1.1.4        colorspace_2.1-1   boot_1.3-30        vctrs_0.6.5        #> [29] R6_2.5.1           lifecycle_1.0.4    stringr_1.5.1      fs_1.6.6           #> [33] htmlwidgets_1.6.4  MASS_7.3-60.2      ragg_1.5.0         pkgconfig_2.0.3    #> [37] desc_1.4.3         pkgdown_2.1.3      pillar_1.10.1      bslib_0.8.0        #> [41] gtable_0.3.6       glue_1.8.0         systemfonts_1.3.1  xfun_0.50          #> [45] tibble_3.2.1       tidyselect_1.2.1   rstudioapi_0.17.1  farver_2.1.2       #> [49] htmltools_0.5.8.1  rmarkdown_2.29     svglite_2.2.2      labeling_0.4.3     #> [53] compiler_4.4.1"},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Silvia Scarpa. Author, maintainer.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Scarpa S (2026). inequantiles: Quantile-Based Inequality Indicators Complex Survey Data. R package version 0.0.0.9000.","code":"@Manual{,   title = {inequantiles: Quantile-Based Inequality Indicators for Complex Survey Data},   author = {Silvia Scarpa},   year = {2026},   note = {R package version 0.0.0.9000}, }"},{"path":"/index.html","id":"inequantiles","dir":"","previous_headings":"","what":"Quantile-Based Inequality Indicators for Complex Survey Data","title":"Quantile-Based Inequality Indicators for Complex Survey Data","text":"inequantiles provides R functions estimation quantile-based inequality indicators, quantile ratio index (QRI), quantiles, also allowing complex sampling data.","code":""},{"path":"/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Quantile-Based Inequality Indicators for Complex Survey Data","text":"can install development version inequantiles GitHub :","code":"# install.packages(\"devtools\")   # run this line if you don't have it yet devtools::install_github(\"silviascarpa/inequantiles\")"},{"path":"/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Quantile-Based Inequality Indicators for Complex Survey Data","text":"","code":"library(inequantiles)  # Example: compute a quantile ratio index (QRI) set.seed(123) N <- 1000 y <- rlnorm(N)  # simulated income data  qri(y) ## Estimate the QRI on a srs  # On (synthetic) survey data  data(synthouse) # Import household survey dataset  csquantile(synthouse$eq_income, weight = synthouse$weight, probs = c(0.25, 0.50, 0.75), type = 6) ### Estimate quantiles on survey data  ## QRI estimation on survey data with type 6 qri(y = synthouse$eq_income, weight = synthouse$weight,  type = 4)   ## Palma index estimation on survey data palma_ratio(y = synthouse$eq_income, weight = synthouse$weight,  type = 6)   ## P90/P10 ratio estimation on survey data ratio_quantiles(y = synthouse$eq_income, weight = synthouse$weight,  prob_numerator = 0.90, prob_denominator = 0.10)   ## Influence function estimation of the QRI (on some observations, as example) if_qri(y = synthouse$eq_income[1:100], weight = synthouse$weight[1:100])"},{"path":"/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2025 Silvia Scarpa Permission hereby granted, free charge, person obtaining copy software associated documentation files (‚ÄúSoftware‚Äù), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED ‚Äú‚Äù, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"/reference/csquantile.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimator of Quantile in case of Simple and Complex Sampling Design ‚Äî csquantile","title":"Estimator of Quantile in case of Simple and Complex Sampling Design ‚Äî csquantile","text":"Computes quantiles weighted unweighted data, allowing sampling weights several interpolation types. method extends standard quantile definitions Hyndman Fan (1996)  Harrell Davis (1982)  estimator case complex survey data incorporating sampling weights cumulative distribution function (CDF) interpolation points, proposed Scarpa et al. (2025) .","code":""},{"path":"/reference/csquantile.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimator of Quantile in case of Simple and Complex Sampling Design ‚Äî csquantile","text":"","code":"csquantile(y, weights = NULL, probs = seq(0, 1, 0.1), type = 4, na.rm = FALSE)"},{"path":"/reference/csquantile.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimator of Quantile in case of Simple and Complex Sampling Design ‚Äî csquantile","text":"y Numeric vector observations. weights Optional numeric vector sampling weights (default: NULL equal weights) probs Numeric vector probabilities (default = seq(0, 1, 0.1)). type Quantile estimation algorithm: integer 4-9 \"HD\" Harrell-Davis (default: 4) na.rm Logical indicating whether remove NA values (default: TRUE)","code":""},{"path":"/reference/csquantile.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimator of Quantile in case of Simple and Complex Sampling Design ‚Äî csquantile","text":"named numeric vector estimated quantiles corresponding probs.","code":""},{"path":"/reference/csquantile.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimator of Quantile in case of Simple and Complex Sampling Design ‚Äî csquantile","text":"Consider random sample \\(s\\) size \\(n\\). Let \\(Y_1, \\ldots, Y_n\\) sample observations finite population, order statistics \\(Y_{(1)} \\le \\ldots \\le Y_{(n)}\\) corresponding sampling weights \\(w_1, \\ldots, w_n\\). Define cumulative weights \\(W_j = \\sum_{\\le j} w_i\\) total weight \\(W_n = \\sum_{=1}^n w_i\\). weighted quantile estimator computed linear interpolation adjacent order statistics: $$   \\widehat{Q}(p)   = Y_{(k-1)} +     (Y_{(k)} - Y_{(k-1)})     \\frac{p - \\widehat{r}_{k-1}}{\\widehat{r}_k - \\widehat{r}_{k-1}}, $$ \\(\\widehat{r}_k\\) denotes estimated cumulative distribution function (‚Äúplotting position‚Äù), order \\(k\\) \\(W_{k-1} - m_{k-1} < W_n p < W_k - m_k\\), \\(m_k\\) determined interpolation method. function supports several interpolation rules (types 4‚Äì9), extending quantile definitions Hyndman Fan (1996)  incorporate sampling weights. table summarizes six interpolation types (4‚Äì9) extended Hyndman Fan (1996)  incorporate sampling weights, described Scarpa et al. (2025) . unweighted data, function returns standard R quantiles. Harrell‚ÄìDavis estimator (\"HD\") also extended weighted case proposed Kreutzmann (2018), redefining weighting coefficients \\(\\widehat{\\mathcal{W}}_j(p)\\) order statistics : $$ \\widehat{\\mathcal{W}}_j(p)   = b_{(W_j / W_n)}\\{(W_n + w_n)p, W_n - (W_n + w_n)p + w_n\\}   - b_{(W_{j-1}/W_n)}\\{(W_n + w_n)p, W_n - (W_n + w_n)p + w_n\\}, $$ \\(b_x(,b)\\) denotes incomplete beta function. resulting quantile estimator \\(\\widehat{Q}_{HD}(p) = \\sum_{j \\s} \\widehat{\\mathcal{W}}_j(p) Y_{(j)}.\\) unweighted data, function returns Harrell & Davis quantile estimator.","code":""},{"path":"/reference/csquantile.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Estimator of Quantile in case of Simple and Complex Sampling Design ‚Äî csquantile","text":"Harrell FE, Davis CE (1982). ‚Äúnew distribution-free quantile estimator.‚Äù Biometrika, 69, 635‚Äì640. Hyndman RJ, Fan Y (1996). ‚ÄúSample quantiles statistical packages.‚Äù American Statistician, 50, 361‚Äì365. Scarpa S, Ferrante MR, Sperlich S (2025). ‚ÄúInference quantile ratio inequality index context survey data.‚Äù Journal Survey Statistics Methodology. doi:10.1093/jssam/smaf024 .","code":""},{"path":"/reference/csquantile.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimator of Quantile in case of Simple and Complex Sampling Design ‚Äî csquantile","text":"","code":"data(synthouse)  y <- synthouse$eq_income ### Income data  # Compute unweighted quantiles (default: type = 4) csquantile(y, probs = c(0.25, 0.5, 0.75), type = 6) #>      25%      50%      75%  #> 12910.48 20429.20 32529.02   # Consider the sampling weights w <- synthouse$weight csquantile(y, weight = w, probs = c(0.25, 0.5, 0.75), type = 6) #>      25%      50%      75%  #> 12353.29 20014.17 32222.93"},{"path":"/reference/gini_grouped.html","id":null,"dir":"Reference","previous_headings":"","what":"Gini Coefficient for Grouped Data ‚Äî gini_grouped","title":"Gini Coefficient for Grouped Data ‚Äî gini_grouped","text":"Computes Gini coefficient grouped income data based linear interpolation income shares.","code":""},{"path":"/reference/gini_grouped.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gini Coefficient for Grouped Data ‚Äî gini_grouped","text":"","code":"gini_grouped(Y, freq)"},{"path":"/reference/gini_grouped.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gini Coefficient for Grouped Data ‚Äî gini_grouped","text":"Y Numeric vector total amounts per group. element represents sum variable interest (e.g. income, wealth, consumption) individuals units group. freq Numeric vector frequencies (number individuals units) per group. Must length Y.","code":""},{"path":"/reference/gini_grouped.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Gini Coefficient for Grouped Data ‚Äî gini_grouped","text":"numeric value representing estimated Gini coefficient grouped data. Gini coefficient ranges 0 (perfect equality) 1 (complete inequality). Note assumes equality within groups.","code":""},{"path":"/reference/gini_grouped.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Gini Coefficient for Grouped Data ‚Äî gini_grouped","text":"Consider grouped data divided \\(L\\) classes known boundaries, observed frequencies \\(f_1, \\ldots, f_L\\) total amounts \\(Y_1, \\ldots, Y_J\\). Gini coefficient approximated linear interpolation cumulative shares, : $$G \\approx 1 - \\sum_{j=1}^{J} (s_j + s_{j-1})(u_j - u_{j-1})$$ : \\(p_j = f_j / \\sum_{=1}^{J} f_i\\) population share group \\(j\\); \\(c_j = Y_j / \\sum_{=1}^{J} Y_i\\) share variable interest group \\(j\\); \\(s_j = \\sum_{k=1}^{j} c_k\\) cumulative share variable group \\(j\\); \\(u_j = \\sum_{k=1}^{j} p_k\\) cumulative population share group \\(j\\); \\(s_0 = u_0 = 0\\) convention. formula computes twice area egalitarian line (perfect equality) Lorenz curve obtained linearly interpolating points \\((u_j, s_j)\\). Since assumes observations within group identical values, provides lower-bound estimate true Gini coefficient ‚Äì actual inequality may larger (Jorda et al. 2021) .","code":""},{"path":"/reference/gini_grouped.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Gini Coefficient for Grouped Data ‚Äî gini_grouped","text":"Important limitations: lower bound approximation. true Gini coefficient may higher due within-group inequality. bias magnitude depends number groups defined. Groups ideally defined maximize within-group homogeneity.","code":""},{"path":"/reference/gini_grouped.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Gini Coefficient for Grouped Data ‚Äî gini_grouped","text":"Jorda V, Sarabia JM, J√§ntti M (2021). ‚ÄúInequality measurement grouped data: Parametric non-parametric methods.‚Äù Journal Royal Statistical Society Series : Statistics Society, 184(3), 964‚Äì984.","code":""},{"path":[]},{"path":"/reference/gini_grouped.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Gini Coefficient for Grouped Data ‚Äî gini_grouped","text":"","code":"income_freq <- c(1200, 1800, 1500, 800, 400, 20, 10) income_tot <- c(18800, 16300, 44700, 33900, 21500, 22100, 98300)  gini_grouped(Y = income_tot, freq = income_freq) #> [1] 0.6201874"},{"path":"/reference/if_gini.html","id":null,"dir":"Reference","previous_headings":"","what":"Influence Function for the Gini Coefficient ‚Äî if_gini","title":"Influence Function for the Gini Coefficient ‚Äî if_gini","text":"Computes influence function Gini coefficient, useful variance estimation complex survey designs. function implements linearization approach described Langel Till√© (2013) .","code":""},{"path":"/reference/if_gini.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Influence Function for the Gini Coefficient ‚Äî if_gini","text":"","code":"if_gini(y, weights = NULL, na.rm = TRUE)"},{"path":"/reference/if_gini.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Influence Function for the Gini Coefficient ‚Äî if_gini","text":"y Numeric vector income variable interest. weights Numeric vector sampling weights. NULL (default), equal weights assumed (simple random sampling). na.rm Logical. missing values removed? Default TRUE.","code":""},{"path":"/reference/if_gini.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Influence Function for the Gini Coefficient ‚Äî if_gini","text":"numeric vector length y containing influence function values observation.","code":""},{"path":"/reference/if_gini.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Influence Function for the Gini Coefficient ‚Äî if_gini","text":"influence function Gini coefficient computed using linearization method, follwing Deville (1999)  framework defined Langel Till√© (2013) . observation \\(k\\) value \\(y_k\\) weight \\(w_k\\), influence function : $$z_k = \\frac{2W_k(y_k - \\bar{Y}_k) + \\hat{Y} - \\hat{N}y_k - G(\\hat{Y} + y_k\\hat{N})}{\\hat{N}\\hat{Y}}$$ : \\(W_k = \\sum_{=1}^k w_i\\) cumulative sum weights rank \\(k\\) \\(\\bar{Y}_k =\\frac{\\sum_{l \\S} w_l y_l 1\\left(W_l \\leqslant W_j\\right)}{W_k}\\) weighted mean values rank \\(k\\) \\(\\hat{N} = \\sum_i w_i\\) total sum weights \\(\\hat{Y} = \\sum_i w_i y_i\\) weighted total variable \\(G\\) Gini coefficient estimate observations ranked values computing influence function.","code":""},{"path":"/reference/if_gini.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Influence Function for the Gini Coefficient ‚Äî if_gini","text":"Deville J (1999). ‚ÄúVariance estimation complex statistics estimators: linearization residual techniques.‚Äù Survey methodology, 25, 193‚Äì204. Langel M, Till√© Y (2013). ‚ÄúVariance estimation Gini index: revisiting result several times published.‚Äù Journal Royal Statistical Society Series , 176, 521‚Äì540.","code":""},{"path":[]},{"path":"/reference/if_gini.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Influence Function for the Gini Coefficient ‚Äî if_gini","text":"","code":"data(synthouse)  eq <- synthouse$eq_income ### Income data  # Simple example z <- if_gini(eq)  # With weights w <- synthouse$weight z_weighted <- if_gini(y = eq, weights = w)"},{"path":"/reference/if_qri.html","id":null,"dir":"Reference","previous_headings":"","what":"Influence Function for the Quantile Ratio Index ‚Äî if_qri","title":"Influence Function for the Quantile Ratio Index ‚Äî if_qri","text":"Computes influence function quantile ratio index (QRI) context finite population observations, defined Scarpa et al. (2025) , simple complex sampling. See Deville (1999)  introduction definition influence function finite population theory.","code":""},{"path":"/reference/if_qri.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Influence Function for the Quantile Ratio Index ‚Äî if_qri","text":"","code":"if_qri(y, weights = NULL, type = 6)"},{"path":"/reference/if_qri.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Influence Function for the Quantile Ratio Index ‚Äî if_qri","text":"y numeric vector data values weights numeric vector sampling weights (optional). NULL, equal weights assumed. type Quantile estimation type: integer 4‚Äì9 HD Harrell‚ÄìDavis (default: 6) See csquantile documentation complete description.","code":""},{"path":"/reference/if_qri.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Influence Function for the Quantile Ratio Index ‚Äî if_qri","text":"numeric vector influence function values (one observation)","code":""},{"path":"/reference/if_qri.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Influence Function for the Quantile Ratio Index ‚Äî if_qri","text":"influence function QRI computed observation $$   \\widehat{z}_i = - \\int_0^1   \\frac{   \\left(     \\frac{\\frac{p}{2} - \\mathbf{1}(y_i \\leq \\widehat{Q}(p/2))}     {\\widehat{f}(\\widehat{Q}(p/2)) \\, \\widehat{N}}   \\right)   \\widehat{Q}(1 - p/2)   -   \\left(     \\frac{(1 - \\frac{p}{2}) - \\mathbf{1}(y_i \\leq \\widehat{Q}(1 - p/2))}     {\\widehat{f}(\\widehat{Q}(1 - p/2)) \\, \\widehat{N}}   \\right)   \\widehat{Q}(p/2)   }{     \\widehat{Q}(1 - p/2)^2   } \\, dp $$ : \\(\\widehat{Q}(p)\\) weighted sample quantile order \\(p\\), computed using internal function csquantile(), \\(\\widehat{f}(\\cdot)\\) denotes estimated income density function, \\(\\widehat{N} = \\sum_i w_i\\) estimated population size. density function \\(\\widehat{f}(y)\\) estimated via Gaussian kernel smoother: $$   \\widehat{f}(y) =   \\frac{1}{\\widehat{N}} \\sum_{j \\s} w_j   K\\!\\left(\\frac{y - y_j}{h}\\right)   =   \\frac{1}{\\widehat{N}\\, h \\sqrt{2\\pi}}   \\sum_{j \\s} w_j   \\exp\\!\\left\\{ -\\frac{(y - y_j)^2}{2h^2} \\right\\}, $$ \\(K(\\cdot)\\) Gaussian kernel. bandwidth chosen : $$   h = 0.79 \\cdot \\mathrm{IQR} \\cdot \\widehat{N}^{-1/5}, $$ \\(\\mathrm{IQR}\\) interquartile range weighted sample.","code":""},{"path":"/reference/if_qri.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Influence Function for the Quantile Ratio Index ‚Äî if_qri","text":"Deville J (1999). ‚ÄúVariance estimation complex statistics estimators: linearization residual techniques.‚Äù Survey methodology, 25, 193‚Äì204. Scarpa S, Ferrante MR, Sperlich S (2025). ‚ÄúInference quantile ratio inequality index context survey data.‚Äù Journal Survey Statistics Methodology. doi:10.1093/jssam/smaf024 .","code":""},{"path":"/reference/if_qri.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Influence Function for the Quantile Ratio Index ‚Äî if_qri","text":"","code":"# On synthetic data eq_synth <- rlnorm(30, 9, 0.7) IF_synth <- if_qri(y = eq_synth)  # On real data eq <- synthouse$eq_income[1:30] ## Take some observations (as example) w <- synthouse$weight[1:30] IF_qri <- if_qri(y = eq, weights = w, type = 6)"},{"path":"/reference/if_qsr.html","id":null,"dir":"Reference","previous_headings":"","what":"Influence Function for the Quintile Share Ratio (QSR) ‚Äî if_qsr","title":"Influence Function for the Quintile Share Ratio (QSR) ‚Äî if_qsr","text":"Computes linearized variable (influence function) quintile share ratio (QSR) using linearization approach based Deville (1999)  derivation Langel Till√© (2011) .","code":""},{"path":"/reference/if_qsr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Influence Function for the Quintile Share Ratio (QSR) ‚Äî if_qsr","text":"","code":"if_qsr(y, weights = NULL, type = 4)"},{"path":"/reference/if_qsr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Influence Function for the Quintile Share Ratio (QSR) ‚Äî if_qsr","text":"y numeric vector income continuous variable. weights numeric vector sampling weights. NULL (default), equal weights assumed observations. type Quantile estimation type: integer 4‚Äì9 \"HD\" Harrell‚ÄìDavis (default: 4)","code":""},{"path":"/reference/if_qsr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Influence Function for the Quintile Share Ratio (QSR) ‚Äî if_qsr","text":"numeric vector length y containing linearized variable \\(\\widehat{z}_k\\) observation.","code":""},{"path":"/reference/if_qsr.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Influence Function for the Quintile Share Ratio (QSR) ‚Äî if_qsr","text":"According definition Langel Till√© (2011)  , influence function QSR given : $$(\\mathrm{QSR})_k=\\frac{y_k-\\left(Y_{0.8}\\right)_k}{Y_{0.2}}-\\frac{\\left(Y-Y_{0.8}\\right) \\left(Y_{0.2}\\right)_k}{Y_{0.2}^2}$$ \\((Y_p)_k = p Q(p) - (Q(p) - y_k) \\mathbb{1}[y_k \\leq Q(p)]\\) influence function partial total quantile \\(p\\) \\(Y_{\\alpha} = \\sum_{j} y_j\\mathbb{1}[y_k \\leq {Q}(\\alpha)]\\). estimated linearized variable : $$\\widehat{z}_k=\\frac{y_k-\\left\\{0.8 \\widehat{Q}(0.8)-\\left(\\widehat{Q}(0.8)-y_k\\right) \\mathbb{1}\\left[y_k \\leq \\widehat{Q}(0.8)\\right]\\right\\}}{\\widehat{Y}_{0.2}}-\\frac{\\left(\\widehat{Y}-\\widehat{Y}_{0.8}\\right)\\left\\{0.2 \\widehat{Q}(0.2)-\\left(\\widehat{Q}(0.2)-y_k\\right) \\mathbb{1}\\left[y_k \\leq \\widehat{Q}(0.2)\\right]\\right\\}}{\\widehat{Y}_{0.2}^2}$$ \\(\\hat{Y}_{\\alpha} = \\sum_{j \\s} w_j y_j\\mathbb{1}[y_k \\leq \\widehat{Q}(\\alpha)]\\) \\(\\widehat{Q}(p)\\) weighted p-th quantile estimator, computed using internal function csquantile().","code":""},{"path":"/reference/if_qsr.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Influence Function for the Quintile Share Ratio (QSR) ‚Äî if_qsr","text":"Deville J (1999). ‚ÄúVariance estimation complex statistics estimators: linearization residual techniques.‚Äù Survey methodology, 25, 193‚Äì204. Langel M, Till√© Y (2011). ‚ÄúStatistical inference quintile share ratio.‚Äù Journal Statistical Planning Inference, 141, 2976‚Äì2985.","code":""},{"path":[]},{"path":"/reference/if_qsr.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Influence Function for the Quintile Share Ratio (QSR) ‚Äî if_qsr","text":"","code":"data(synthouse)  eq <- synthouse$eq_income ### Income data  # Simple example z <- if_qsr(eq)  # With weights w <- synthouse$weight z_weighted <- if_qsr(y = eq, weights = w)"},{"path":"/reference/if_quantile.html","id":null,"dir":"Reference","previous_headings":"","what":"Influence Function for Quantiles ‚Äî if_quantile","title":"Influence Function for Quantiles ‚Äî if_quantile","text":"Computes influence function sample quantiles, allowing simple random sampling complex survey designs sampling weights, context finite population. See Hampel et al. (1986)  explanation influence function Deville (1999)  definition finite population theory.","code":""},{"path":"/reference/if_quantile.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Influence Function for Quantiles ‚Äî if_quantile","text":"","code":"if_quantile(y, weights = NULL, probs, type = 6, na.rm = TRUE)"},{"path":"/reference/if_quantile.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Influence Function for Quantiles ‚Äî if_quantile","text":"y numeric vector data values weights numeric vector sampling weights (optional) probs numeric value specifying probability quantile (e.g., 0.5 median) type Quantile estimation type: integer 4-9 \"HD\" Harrell-Davis (default: 6) na.rm Logical, missing values removed? (default: TRUE)","code":""},{"path":"/reference/if_quantile.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Influence Function for Quantiles ‚Äî if_quantile","text":"numeric vector containing estimtaed quantile influence function values observation.","code":""},{"path":"/reference/if_quantile.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Influence Function for Quantiles ‚Äî if_quantile","text":"definiton Van der Vaart (2000)  (Osier 2009) , population influence function quantile \\(Q(p)\\) defined : $$(Q(p))_i = \\frac{p - \\mathbf{1}(y_i \\leq Q(p))}{f(Q(p)) \\, N},$$ \\(f(Q(p))\\) population density function evaluated quantile \\(N\\) population size. sample, estimated : $$\\widehat{}(Q(p))_i = \\frac{p - \\mathbf{1}(y_i \\leq \\widehat{Q}(p))}{\\widehat{f}(\\widehat{Q}(p)) \\, \\widehat{N}},$$ \\(\\widehat{Q}(p)\\) weighted sample quantile estimated csquantile(), \\(\\widehat{N} = \\sum_{\\s} w_i\\) estimated population size. density \\(\\widehat{f}(y)\\) estimated using Gaussian kernel density function: $$ \\widehat{f}(y) = \\frac{1}{\\widehat{N} \\, h \\sqrt{2\\pi}} \\sum_{j \\s} w_j \\exp\\!\\left\\{ -\\frac{(y - y_j)^2}{2h^2} \\right\\}, $$ bandwidth \\(h = 0.79 \\cdot IQR \\cdot \\widehat{N}^{-1/5}\\)","code":""},{"path":"/reference/if_quantile.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Influence Function for Quantiles ‚Äî if_quantile","text":"Hampel FR, Ronchetti E, Rousseeuw P, Stahel W (1986). Robust statistics: approach based influence functions. John Wiley & Sons. Deville J (1999). ‚ÄúVariance estimation complex statistics estimators: linearization residual techniques.‚Äù Survey methodology, 25, 193‚Äì204. Van der Vaart AW (2000). Asymptotic statistics, volume 3. Cambridge University Press. Osier G (2009). ‚ÄúVariance estimation complex indicators poverty inequality using linearization techniques.‚Äù Survey Research Methods, 3, 167‚Äì195.","code":""},{"path":"/reference/if_quantile.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Influence Function for Quantiles ‚Äî if_quantile","text":"","code":"# On synthetic data eq_synth <- rlnorm(30, 9, 0.7) IF_synth <- if_quantile(y = eq_synth, probs = 0.3)  # On real data data(synthouse) eq <- synthouse$eq_income[1:30] ## Take some observations (as example) w <- synthouse$weight[1:30] IF_quantile <- if_quantile(y = eq, weights = w, type = 6, probs = 0.5)"},{"path":"/reference/palma_ratio.html","id":null,"dir":"Reference","previous_headings":"","what":"Palma Ratio Estimator ‚Äî palma_ratio","title":"Palma Ratio Estimator ‚Äî palma_ratio","text":"Computes Palma ratio estimator measuring inequality simple complex sampling data","code":""},{"path":"/reference/palma_ratio.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Palma Ratio Estimator ‚Äî palma_ratio","text":"","code":"palma_ratio(y, weights = NULL, type = 6, na.rm = TRUE)"},{"path":"/reference/palma_ratio.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Palma Ratio Estimator ‚Äî palma_ratio","text":"y numeric vector data values weights numeric vector sampling weights (optional) type Quantile estimation type: integer 4-9 HD Harrell-Davis (default: 6). See csquantile documentation complete description. na.rm Logical, missing values removed? (default: TRUE)","code":""},{"path":"/reference/palma_ratio.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Palma Ratio Estimator ‚Äî palma_ratio","text":"scalar numeric value representing estimated inequality Palma ratio.","code":""},{"path":"/reference/palma_ratio.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Palma Ratio Estimator ‚Äî palma_ratio","text":"Consider random sample \\(s\\) size \\(n\\), let \\(w_j\\), \\(j \\s\\), define sampling weight \\(y_j\\) observed characteristics (.e. income) associated \\(j\\)-th individual, \\(j = 1, \\ldots, n\\). According Cobham Sumner (2013)  definition, Palma index divides share earned richest 10\\ poorest 40\\ $$\\widehat{Palma} = \\frac{\\sum_{j \\s}w_j y_j \\mathds{1}\\left\\{ y_j \\geq \\widehat{Q}(0.9)\\right\\} }{\\sum_{j \\s} w_j y_j\\mathds{1}\\left\\{ y_j \\leq \\widehat{Q}(0.4)\\right\\} }$$ estimated quantiles \\(\\widehat{Q}(p)\\) computed via function csquantile(), accounts sampling weights specified quantile type. allows \\(\\widehat{Palma}\\) used simple random samples complex survey data design weights. See  Palma (2006)  Palma (2011)  introduction Palma ratio.","code":""},{"path":"/reference/palma_ratio.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Palma Ratio Estimator ‚Äî palma_ratio","text":"Palma JG (2006). ‚ÄúGlobalizing Inequality: ‚ÄòCentrifugal‚Äô ‚ÄòCentripetal‚Äô Forces Work.‚Äù United Nations, Department Economics Social Affairs. Palma JG (2011). ‚ÄúHomogeneous middles vs. heterogeneous tails, end ‚Äòinverted-U‚Äô: share rich.‚Äù Development Change, 42, 87‚Äì153. Cobham , Sumner (2013). ‚Äútails? Palma measure income inequality.‚Äù Center Global Development working paper.","code":""},{"path":"/reference/palma_ratio.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Palma Ratio Estimator ‚Äî palma_ratio","text":"","code":"data(synthouse)  eq <- synthouse$eq_income ### Income data  # Compute unweighted Palma index with default type 6 quantile estimator palma_ratio(y = eq) #> [1] 1.568589  # Consider the sampling weights and change quantile estimation type w <- synthouse$weight palma_ratio(y = eq, weights = w, type = 5) #> [1] 1.578482  # Compare the Palma index across macro-regions (NUTS1) tapply(1:nrow(synthouse), synthouse$NUTS1, function(area) {   palma_ratio(y = synthouse$eq_income[area],       weights = synthouse$weight[area],       type = 6) }) #>        C        N       NE       NO        S  #> 1.629047 1.588659 1.624684 1.739012 1.455656"},{"path":"/reference/qri.html","id":null,"dir":"Reference","previous_headings":"","what":"Quantile Ratio Index Estimator ‚Äî qri","title":"Quantile Ratio Index Estimator ‚Äî qri","text":"Computes quantile ratio index (QRI) estimator measuring inequality simple complex sampling data","code":""},{"path":"/reference/qri.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Quantile Ratio Index Estimator ‚Äî qri","text":"","code":"qri(y, weights = NULL, M = 100, type = 6, na.rm = TRUE)"},{"path":"/reference/qri.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Quantile Ratio Index Estimator ‚Äî qri","text":"y numeric vector data values weights numeric vector sampling weights (optional) M Integer, number quantile ratios average (default: 100) type Quantile estimation type: integer 4-9 HD Harrell-Davis (default: 6). See csquantile documentation complete description. na.rm Logical, missing values removed? (default: TRUE)","code":""},{"path":"/reference/qri.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Quantile Ratio Index Estimator ‚Äî qri","text":"scalar numeric value representing estimated inequality quantile ratio index (QRI).","code":""},{"path":"/reference/qri.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Quantile Ratio Index Estimator ‚Äî qri","text":"Consider random sample \\(s\\) size, \\(w_j\\), \\(j \\s\\), defines sampling weight associated \\(j\\)-th individual. QRI estimator defined : $$\\widehat{QRI} = \\frac{1}{M}\\sum_{m=1}^M\\left(1- \\frac{\\widehat{Q}(p_{m/2})}{\\widehat{Q}(1 - p_{m/2})}\\right)$$ \\(p_m = p_m = (m-0.5)/M\\). estimated quantiles \\(\\widehat{Q}(p)\\) computed via function csquantile(), accounts sampling weights specified quantile type. allows \\(\\widehat{QRI}\\) used simple random samples complex survey data design weights. index proposed Prendergast Staudte (2018) , extended survey data Scarpa et al. (2025) .","code":""},{"path":"/reference/qri.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Quantile Ratio Index Estimator ‚Äî qri","text":"Prendergast LA, Staudte RG (2018). ‚Äúsimple effective inequality measure.‚Äù American Statistician, 72, 328‚Äì343. Scarpa S, Ferrante MR, Sperlich S (2025). ‚ÄúInference quantile ratio inequality index context survey data.‚Äù Journal Survey Statistics Methodology. doi:10.1093/jssam/smaf024 .","code":""},{"path":"/reference/qri.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Quantile Ratio Index Estimator ‚Äî qri","text":"","code":"data(synthouse)  eq <- synthouse$eq_income ### Income data  # Compute unweighted QRI with default type 6 quantile estimator qri(y = eq) #> [1] 0.5611575  # Consider the sampling weights and change quantile estimation type w <- synthouse$weight qri(y = eq, weights = w, type = 5) #> [1] 0.5690882  # Compare QRI across macro-regions (NUTS1) tapply(1:nrow(synthouse), synthouse$NUTS1, function(area) {   qri(y = synthouse$eq_income[area],       weights = synthouse$weight[area],       type = 6) }) #>         C         N        NE        NO         S  #> 0.5847404 0.5639082 0.5691184 0.5796789 0.5601799"},{"path":"/reference/qri_grouped.html","id":null,"dir":"Reference","previous_headings":"","what":"Quantile Ratio Rndex Estimator for Grouped (Binned) Data ‚Äî qri_grouped","title":"Quantile Ratio Rndex Estimator for Grouped (Binned) Data ‚Äî qri_grouped","text":"Computes quantile ratio index (QRI) measuring inequality grouped frequency data using linear interpolation quantile estimation. function intended used administrative tax data, often form grouped (binned) data. Therefore, sampling weights considered.","code":""},{"path":"/reference/qri_grouped.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Quantile Ratio Rndex Estimator for Grouped (Binned) Data ‚Äî qri_grouped","text":"","code":"qri_grouped(   freq,   lower_bounds,   upper_bounds,   M = 100,   midpoints = NULL,   na.rm = TRUE )"},{"path":"/reference/qri_grouped.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Quantile Ratio Rndex Estimator for Grouped (Binned) Data ‚Äî qri_grouped","text":"freq Numeric vector class frequencies (counts). Must non-negative. lower_bounds Numeric vector lower class bounds. upper_bounds Numeric vector upper class bounds. M Integer, number quantile ratios average (default: 100). midpoints Optional numeric vector class midpoints. Used fallback quantile class zero frequency. na.rm Logical, missing values frequencies removed? (default: TRUE)","code":""},{"path":"/reference/qri_grouped.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Quantile Ratio Rndex Estimator for Grouped (Binned) Data ‚Äî qri_grouped","text":"scalar numeric value representing estimated inequality quantile ratio index (QRI) grouped data.","code":""},{"path":"/reference/qri_grouped.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Quantile Ratio Rndex Estimator for Grouped (Binned) Data ‚Äî qri_grouped","text":"Consider grouped data divided \\(L\\) classes known boundaries observed frequencies \\(f_1, \\ldots, f_L\\). QRI estimator grouped data approximated : $${QRI} \\approx \\frac{1}{M}\\sum_{m=1}^{M}\\left(1 - \\frac{\\widetilde{Q}(p_m/2)}{\\widetilde{Q}(1 - p_m/2)}\\right)$$ : \\(p_m = (m - 0.5)/M\\) \\(m=1, \\ldots, M\\) \\(\\widetilde{Q}(p)\\) denotes \\(p\\)-th quantile computed grouped data using linear interpolation (see quantile_grouped) \\(M\\) number quantile ratios average (default: 100) quantiles \\(\\widetilde{Q}(p)\\) computed via quantile_grouped(), uses linear interpolation within classes automatically handles open-ended classes (-Inf Inf bounds). QRI ranges 0 (perfect equality) 1 (maximum inequality). index measures inequality averaging relative differences symmetric quantiles median, across entire distribution.","code":""},{"path":"/reference/qri_grouped.html","id":"comparison-with-microdata-qri","dir":"Reference","previous_headings":"","what":"Comparison with Microdata QRI","title":"Quantile Ratio Rndex Estimator for Grouped (Binned) Data ‚Äî qri_grouped","text":"individual-level (microdata) available, use qri instead, provides accurate estimates. grouped data version qri_grouped used frequency distributions available, published statistical tables administrative aggregates. grouped QRI generally approximate microdata QRI well : Classes sufficiently narrow distribution within classes approximately uniform Sample sizes within classes adequate","code":""},{"path":"/reference/qri_grouped.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Quantile Ratio Rndex Estimator for Grouped (Binned) Data ‚Äî qri_grouped","text":"Prendergast LA, Staudte RG (2018). ‚Äúsimple effective inequality measure.‚Äù American Statistician, 72, 328‚Äì343.","code":""},{"path":[]},{"path":"/reference/qri_grouped.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Quantile Ratio Rndex Estimator for Grouped (Binned) Data ‚Äî qri_grouped","text":"","code":"# Basic example with closed classes income_freq <- c(120, 180, 150, 80, 40, 20, 10) income_lower <- c(0, 15000, 30000, 45000, 60000, 80000, 100000) income_upper <- c(15000, 30000, 45000, 60000, 80000, 100000, 150000)  qri_grouped(income_freq, income_lower, income_upper) #> [1] 0.5888192  # Example with open-ended classes (Italian MEF-style data) wage_freq <- c(150, 200, 180, 220, 180, 50, 15, 5) wage_lower <- c(-Inf, 0, 10000, 15000, 26000, 55000, 75000, 120000) wage_upper <- c(0, 10000, 15000, 26000, 55000, 75000, 120000, Inf)  # Compute QRI (automatically handles open classes) qri_grouped(wage_freq, wage_lower, wage_upper) #> [1] 0.7268536"},{"path":"/reference/qsr.html","id":null,"dir":"Reference","previous_headings":"","what":"Quintile Share Ratio Estimator ‚Äî qsr","title":"Quintile Share Ratio Estimator ‚Äî qsr","text":"Computes quintile share ratio (QSR) estimator measuring inequality simple complex sampling data","code":""},{"path":"/reference/qsr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Quintile Share Ratio Estimator ‚Äî qsr","text":"","code":"qsr(y, weights = NULL, type = 6, na.rm = TRUE)"},{"path":"/reference/qsr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Quintile Share Ratio Estimator ‚Äî qsr","text":"y numeric vector data values weights numeric vector sampling weights (optional) type Quantile estimation type: integer 4-9 HD Harrell-Davis (default: 6). See csquantile documentation complete description. na.rm Logical, missing values removed? (default: TRUE)","code":""},{"path":"/reference/qsr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Quintile Share Ratio Estimator ‚Äî qsr","text":"scalar numeric value representing estimated inequality quintile share ratio (QSR).","code":""},{"path":"/reference/qsr.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Quintile Share Ratio Estimator ‚Äî qsr","text":"Consider random sample \\(s\\) size \\(n\\), let \\(w_j\\), \\(j \\s\\), define sampling weight \\(y_j\\) observed characteristics (.e. income) associated \\(j\\)-th individual, \\(j = 1, \\ldots, n\\). QSR estimator defined : $$\\widehat{QSR} = \\frac{\\sum_{j \\s}w_j y_j \\mathds{1}\\left\\{ y_j \\geq \\widehat{Q}(0.8)\\right\\} }{\\sum_{j \\s} w_j y_j\\mathds{1}\\left\\{ y_j \\leq \\widehat{Q}(0.2)\\right\\} }$$ estimated quantiles \\(\\widehat{Q}(p)\\) computed via function csquantile(), accounts sampling weights specified quantile type. allows \\(\\widehat{QSR}\\) used simple random samples complex survey data design weights. See  Langel Till√© (2011)  complete review QSR estimator complex sampling data.","code":""},{"path":"/reference/qsr.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Quintile Share Ratio Estimator ‚Äî qsr","text":"Langel M, Till√© Y (2011). ‚ÄúStatistical inference quintile share ratio.‚Äù Journal Statistical Planning Inference, 141, 2976‚Äì2985.","code":""},{"path":"/reference/qsr.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Quintile Share Ratio Estimator ‚Äî qsr","text":"","code":"data(synthouse)  eq <- synthouse$eq_income ### Income data  # Compute unweighted QSR with default type 6 quantile estimator qsr(y = eq) #> [1] 6.905899  # Consider the sampling weights and change quantile estimation type w <- synthouse$weight qsr(y = eq, weights = w, type = 5) #> [1] 7.016053  # Compare QSR across macro-regions (NUTS1) tapply(1:nrow(synthouse), synthouse$NUTS1, function(area) {   qsr(y = synthouse$eq_income[area],       weights = synthouse$weight[area],       type = 6) }) #>        C        N       NE       NO        S  #> 7.329234 6.892276 7.127548 7.746556 6.530128"},{"path":"/reference/quantile_grouped.html","id":null,"dir":"Reference","previous_headings":"","what":"Quantile Estimator for Grouped (Binned) Data ‚Äî quantile_grouped","title":"Quantile Estimator for Grouped (Binned) Data ‚Äî quantile_grouped","text":"Computes quantiles grouped frequency data using linear interpolation within quantile class.","code":""},{"path":"/reference/quantile_grouped.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Quantile Estimator for Grouped (Binned) Data ‚Äî quantile_grouped","text":"","code":"quantile_grouped(   freq,   lower_bounds,   upper_bounds,   probs = 0.5,   midpoints = NULL )"},{"path":"/reference/quantile_grouped.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Quantile Estimator for Grouped (Binned) Data ‚Äî quantile_grouped","text":"freq Numeric vector class frequencies (counts). Must non-negative. lower_bounds Numeric vector lower class bounds. Must strictly increasing. upper_bounds Numeric vector upper class bounds. Must strictly increasing greater corresponding lower_bounds. probs Numeric vector probabilities (0 1) compute quantiles. Default 0.5 (median). midpoints Optional numeric vector class midpoints. Used fallback quantile class zero frequency. NULL, midpoint computed arithmetic mean class bounds.","code":""},{"path":"/reference/quantile_grouped.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Quantile Estimator for Grouped (Binned) Data ‚Äî quantile_grouped","text":"vector estimated quantiles grouped data corresponding probs. Returns NA total frequency zero missing.","code":""},{"path":"/reference/quantile_grouped.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Quantile Estimator for Grouped (Binned) Data ‚Äî quantile_grouped","text":"Consider grouped data divided \\(L\\) classes known boundaries. Let: \\(L_j\\) lower bound \\(j\\)-th quantile class \\(U_j\\) upper bound \\(j\\)-th quantile class \\(h_j = U_j - L_j\\) \\(j\\)-th quantile class width \\(C_{j-1}\\) cumulative frequency previous class \\(f_j\\) frequency within quantile class \\(j\\) \\(N = \\sum_{=1}^{k} f_i\\) total frequency quantile class \\(p\\)-th quantile first class \\(j\\) : $$j = min\\{: C_i \\geq pN \\}$$. \\(p\\)-th quantile \\(Q(p)\\) estimated linear interpolation within quantile class: $$\\widetilde{Q(p)} = L_j + \\frac{(pN - C_{j-1})}{f_j} \\cdot h_j$$ method assumes uniform distribution observations within class interval. standard approach grouped data individual observations available.","code":""},{"path":"/reference/quantile_grouped.html","id":"handling-open-ended-classes","dir":"Reference","previous_headings":"","what":"Handling Open-Ended Classes","title":"Quantile Estimator for Grouped (Binned) Data ‚Äî quantile_grouped","text":"dealing administrative tax data, first class often often defined negative income  (incomes zero) last class incomes certain threshold. cases, -Inf lower bound first class Inf upper bound last class. Inf values present given bounds, function imputes reasonable bounds using specified method: open left class (first lower bound = -Inf): imputed first lower bound given : $$L_1^* = U_1 - h_2$$ \\(U_1\\) upper bound first class \\(h_2 = U_2 - L_2\\) width second class. assumes first class width second class. open right class (last upper bound = Inf): imputed upper bound given : $$U_J^* = L_J + h_{J-1}$$ \\(L_J\\) lower bound last class \\(h_{J-1} = U_{J-1} - L_{J-1}\\) width second--last class. assumes last class width penultimate class.","code":""},{"path":"/reference/quantile_grouped.html","id":"special-cases","dir":"Reference","previous_headings":"","what":"Special Cases","title":"Quantile Estimator for Grouped (Binned) Data ‚Äî quantile_grouped","text":"quantile class zero frequency, function returns class midpoint fallback. total frequency zero NA, function returns NA requested quantiles.","code":""},{"path":[]},{"path":"/reference/quantile_grouped.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Quantile Estimator for Grouped (Binned) Data ‚Äî quantile_grouped","text":"","code":"# Basic usage: compute quartiles freq <- c(5, 8, 10, 4, 3) lower <- c(0, 10, 20, 30, 40) upper <- c(10, 20, 30, 40, 50)  quantile_grouped(freq, lower, upper, probs = c(0.25, 0.5, 0.75)) #>   25 %   50 %   75 %  #> 13.125 22.000 29.500   # Compute deciles quantile_grouped(freq, lower, upper, probs = seq(0.1, 0.9, by = 0.1)) #>  10 %  20 %  30 %  40 %  50 %  60 %  70 %  80 %  90 %  #>  6.00 11.25 15.00 18.75 22.00 25.00 28.00 32.50 40.00   # With custom midpoints midpts <- c(5, 15, 25, 35, 45) quantile_grouped(freq, lower, upper, probs = 0.5, midpoints = midpts) #> 50 %  #>   22   # Income distribution example income_freq <- c(120, 180, 150, 80, 40, 20, 10) income_lower <- c(0, 15000, 30000, 45000, 60000, 80000, 100000) income_upper <- c(15000, 30000, 45000, 60000, 80000, 100000, 150000)  # Compute median income quantile_grouped(income_freq, income_lower, income_upper, probs = 0.5) #>  50 %  #> 30000   # Compute income quintiles quantile_grouped(income_freq, income_lower, income_upper,                    probs = seq(0.2, 0.8, by = 0.2)) #>  20 %  40 %  60 %  80 %  #> 15000 25000 36000 50625"},{"path":"/reference/ratio_quantiles.html","id":null,"dir":"Reference","previous_headings":"","what":"Ratio of Quantiles Estimator (e.g., P90/P10) ‚Äî ratio_quantiles","title":"Ratio of Quantiles Estimator (e.g., P90/P10) ‚Äî ratio_quantiles","text":"Estimates ratio quantiles (e.g., P90/P10) simple complex sampling data","code":""},{"path":"/reference/ratio_quantiles.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ratio of Quantiles Estimator (e.g., P90/P10) ‚Äî ratio_quantiles","text":"","code":"ratio_quantiles(   y,   weights = NULL,   prob_numerator = 0.9,   prob_denominator = 0.1,   type = 6,   na.rm = FALSE )"},{"path":"/reference/ratio_quantiles.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Ratio of Quantiles Estimator (e.g., P90/P10) ‚Äî ratio_quantiles","text":"y numeric vector data values weights numeric vector sampling weights (optional) prob_numerator percentile considered numerator (default 0.90) prob_denominator percentile considered denominator (default 0.10 type Quantile estimation type: integer 4-9 HD Harrell-Davis (default: 6). See csquantile documentation complete description. na.rm Logical, missing values removed? (default: TRUE)","code":""},{"path":"/reference/ratio_quantiles.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Ratio of Quantiles Estimator (e.g., P90/P10) ‚Äî ratio_quantiles","text":"scalar numeric value representing estimated ratio quantiles","code":""},{"path":"/reference/ratio_quantiles.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Ratio of Quantiles Estimator (e.g., P90/P10) ‚Äî ratio_quantiles","text":"Consider random sample \\(s\\) size \\(n\\), let \\(w_j\\), \\(j \\s\\), define sampling weight \\(y_j\\) observed characteristics (.e. income) associated \\(j\\)-th individual, \\(j = 1, \\ldots, n\\). Let \\(p_{top}\\) order quantile numerator \\(p_{bottom}\\) order quantile denominator. example, set \\(p_{top} = 0.90\\) \\(p_{bottom} = 0.10\\). popular P90/P10 ratio can estimated $$\\widehat{{P}90/{P}10} = \\frac{\\widehat{Q}(p=0.9)}{\\widehat{Q}(p=0.1)}  $$ estimated quantiles \\(\\widehat{Q}(p)\\) computed via function csquantile(), accounts sampling weights specified quantile type.","code":""},{"path":"/reference/ratio_quantiles.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Ratio of Quantiles Estimator (e.g., P90/P10) ‚Äî ratio_quantiles","text":"","code":"data(synthouse)  eq <- synthouse$eq_income ### Income data  # Compute unweighted P90/P10 with default type 6 quantile estimator ratio_quantiles(y = eq) #> [1] 5.712946  # Consider the sampling weights, change quantile estimation type and orders of quantiles w <- synthouse$weight ratio_quantiles(y = eq, weights = w, prob_numerator = 0.6, prob_denominator = 0.1, type = 5) #> [1] 2.953968  # Compare the P90/P10 across macro-regions (NUTS1) tapply(1:nrow(synthouse), synthouse$NUTS1, function(area) {   ratio_quantiles(y = synthouse$eq_income[area],       weights = synthouse$weight[area]) }) #>        C        N       NE       NO        S  #> 6.267395 5.595916 5.961529 6.278178 5.401721"},{"path":"/reference/rescaled_bootstrap.html","id":null,"dir":"Reference","previous_headings":"","what":"Rescaled Bootstrap Variance Estimation ‚Äî rescaled_bootstrap","title":"Rescaled Bootstrap Variance Estimation ‚Äî rescaled_bootstrap","text":"Implements rescaled bootstrap method variance estimation survey data, supporting stratified simple random sampling multistage complex designs.","code":""},{"path":"/reference/rescaled_bootstrap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Rescaled Bootstrap Variance Estimation ‚Äî rescaled_bootstrap","text":"","code":"rescaled_bootstrap(   data,   y,   strata,   N_h = NULL,   psu = NULL,   weights = NULL,   estimator,   by_strata = TRUE,   B = 200,   m_h = NULL,   seed = NULL )"},{"path":"/reference/rescaled_bootstrap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Rescaled Bootstrap Variance Estimation ‚Äî rescaled_bootstrap","text":"data data frame containing survey data. y character string specifying variable name used target variable. strata character string specifying stratification variable. N_h Optional vector stratum population sizes, used finite population correction (FPC). Can single value (applied strata) one value per stratum. psu Optional character string specifying Primary Sampling Unit (PSU) variable. Required multistage complex designs. weights Optional character string specifying sampling weight variable. Required complex designs unequal inclusion probabilities. estimator function computes statistic interest, accepting arguments estimator(y, weights) complex designs estimator(y) simple designs. by_strata Logical; TRUE, variances computed separately stratum. B Integer; number bootstrap replicates (default = 200). m_h Optional vector bootstrap sample sizes per stratum (PSUs complex designs). NULL, defaults \\(m_h = \\lfloor (n_h - 2)^2 / (n_h - 1) \\rfloor\\). seed Optional integer reproducibility.","code":""},{"path":"/reference/rescaled_bootstrap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Rescaled Bootstrap Variance Estimation ‚Äî rescaled_bootstrap","text":"list containing: variance Bootstrap variance estimate boot_estimates Vector B bootstrap estimates B Number bootstrap replicates by_strata variance computed stratum overall design sampling design complex (sampling weights) simple strata_info Returns information number observations/PSUs per stratum call matched function call.","code":""},{"path":"/reference/rescaled_bootstrap.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Rescaled Bootstrap Variance Estimation ‚Äî rescaled_bootstrap","text":"rescaled bootstrap resampling technique designed complex survey data preserves stratification primary sampling unit (PSU) structure, providing consistent variance estimation smooth non-smooth statistics. methodology based Rao Wu (1988)  Rao et al. (1992) . (1) Stratified Simple Random Sampling Consider finite population divided \\(H\\) strata, size \\(N_h\\), sample size \\(n_h\\) selected independently stratum. \\(b\\) bootstrap replicate, \\(b = \\ldots, B\\): Draw bootstrap sample size \\(m_h\\) replacement \\(n_h\\) sampled units. default, \\(m_h = \\lfloor (n_h - 2)^2 / (n_h - 1) \\rfloor \\approx n_h - 3\\). Compute rescaled bootstrap values: $$           \\tilde{y}_{hj}^{*(b)} = \\bar{y}_h +           \\sqrt{\\frac{m_h(1-f_h)}{n_h - 1}}           (y_{hj}^{*(b)} - \\bar{y}_h), $$ \\(y_{hj}^*\\) bootstrap observation \\(f_h = n_h / N_h\\) sampling fraction \\(\\bar{y}_h\\) sample stratum mean. Compute statistic interest \\(\\hat{\\theta}^{*(b)}\\) using rescaled values. bootstrap variance given : $$   \\widehat{V}_{boot}(\\hat{\\theta}) =   \\frac{1}{B-1} \\sum_{b=1}^{B}   \\left( \\hat{\\theta}^{*(b)} - \\bar{\\theta}^{*} \\right)^2,   \\qquad   \\bar{\\theta}^{*} = \\frac{1}{B} \\sum_{b=1}^{B} \\hat{\\theta}^{*(b)}. $$ (2) Two-Stage Stratified Sampling (Complex Designs) designs PSUs sampling weights: Within stratum \\(h\\), draw \\(m_h\\) PSUs replacement \\(n_h\\) sampled PSUs. default, \\(m_h = \\lfloor (n_h - 2)^2 / (n_h - 1) \\rfloor \\approx n_h - 3\\). Let \\(m_{hi}^{(b)}\\) denote number times PSU \\(\\) selected replicate \\(b\\). observation \\(\\)-th PSU assigned rescaled bootstrap weight: $$           w_{hij}^{*(b)} =           \\left[             1 - c_h + c_h \\frac{n_h}{m_h} m_{hi}^{(b)}           \\right] w_{hij},           \\qquad           c_h = \\sqrt{\\frac{m_h}{n_h - 1}}.         $$ \\(w_{hij}\\) sampling weight associtaed individual \\(j\\) PSU \\(\\) stratum \\(h\\)- statistic \\(\\hat{\\theta}^{*(b)}\\) computed using rescaled weights. rescaled bootstrap variance estimate : $$   \\widehat{V}_{boot}(\\hat{\\theta}) =   \\frac{1}{B-1} \\sum_{b=1}^{B}   \\left( \\hat{\\theta}^{*(b)} - \\bar{\\theta}^{*} \\right)^2. $$","code":""},{"path":"/reference/rescaled_bootstrap.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Rescaled Bootstrap Variance Estimation ‚Äî rescaled_bootstrap","text":"Rao J, Wu C (1988). ‚ÄúResampling inference complex survey data.‚Äù Journal American Statistical Association, 83, 231‚Äì241. Rao J, Wu C, Yue K (1992). ‚Äúrecent work resampling methods complex surveys.‚Äù Survey methodology, 18, 209‚Äì217. Kolenikov S (2010). ‚ÄúResampling variance estimation complex survey data.‚Äù Stata Journal, 10, 165‚Äì199. Scarpa S, Ferrante MR, Sperlich S (2025). ‚ÄúInference quantile ratio inequality index context survey data.‚Äù Journal Survey Statistics Methodology. doi:10.1093/jssam/smaf024 .","code":""},{"path":"/reference/rescaled_bootstrap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Rescaled Bootstrap Variance Estimation ‚Äî rescaled_bootstrap","text":"","code":"# \\donttest{ data(synthouse)   # ================================================================ # Example 1: Stratified Simple Random Sampling (SRS) # ================================================================   # Use NUTS2 as strata set.seed(123)  # Simulate population sizes per stratum (for FPC) N_values <- sample(2000:5000, length(unique(synthouse$NUTS2)), replace = TRUE) names(N_values) <- sort(unique(synthouse$NUTS2))  # Define a simple mean estimator mean_estimator <- function(y) mean(y, na.rm = TRUE)  # Apply the rescaled bootstrap under stratified SRS boot_srs <- rescaled_bootstrap(   data = synthouse,   y = \"eq_income\",   strata = \"NUTS2\",   N_h = N_values,   estimator = mean_estimator,   by_strata = TRUE,   B = 50,  # small number for illustration   seed = 123 ) #>    |                                                                               |                                                                      |   0%   |                                                                               |=                                                                     |   2%   |                                                                               |===                                                                   |   4%   |                                                                               |====                                                                  |   6%   |                                                                               |======                                                                |   8%   |                                                                               |=======                                                               |  10%   |                                                                               |========                                                              |  12%   |                                                                               |==========                                                            |  14%   |                                                                               |===========                                                           |  16%   |                                                                               |=============                                                         |  18%   |                                                                               |==============                                                        |  20%   |                                                                               |===============                                                       |  22%   |                                                                               |=================                                                     |  24%   |                                                                               |==================                                                    |  26%   |                                                                               |====================                                                  |  28%   |                                                                               |=====================                                                 |  30%   |                                                                               |======================                                                |  32%   |                                                                               |========================                                              |  34%   |                                                                               |=========================                                             |  36%   |                                                                               |===========================                                           |  38%   |                                                                               |============================                                          |  40%   |                                                                               |=============================                                         |  42%   |                                                                               |===============================                                       |  44%   |                                                                               |================================                                      |  46%   |                                                                               |==================================                                    |  48%   |                                                                               |===================================                                   |  50%   |                                                                               |====================================                                  |  52%   |                                                                               |======================================                                |  54%   |                                                                               |=======================================                               |  56%   |                                                                               |=========================================                             |  58%   |                                                                               |==========================================                            |  60%   |                                                                               |===========================================                           |  62%   |                                                                               |=============================================                         |  64%   |                                                                               |==============================================                        |  66%   |                                                                               |================================================                      |  68%   |                                                                               |=================================================                     |  70%   |                                                                               |==================================================                    |  72%   |                                                                               |====================================================                  |  74%   |                                                                               |=====================================================                 |  76%   |                                                                               |=======================================================               |  78%   |                                                                               |========================================================              |  80%   |                                                                               |=========================================================             |  82%   |                                                                               |===========================================================           |  84%   |                                                                               |============================================================          |  86%   |                                                                               |==============================================================        |  88%   |                                                                               |===============================================================       |  90%   |                                                                               |================================================================      |  92%   |                                                                               |==================================================================    |  94%   |                                                                               |===================================================================   |  96%   |                                                                               |===================================================================== |  98%   |                                                                               |======================================================================| 100%  # View results boot_srs$variance #>       C01       C02       C03       C04       C05       C06       N01       N02  #>  499863.9  573118.2  671053.7  545446.5  775512.9  475065.6  341097.8  350873.9  #>       N03       N04       N05       N06      NE01      NE02      NE03      NE04  #>  307397.0  232378.7  320968.3  398986.7  509534.9  371716.5  416917.1  551225.8  #>      NE05      NE06      NO01      NO02      NO03      NO04      NO05      NO06  #>  447320.5  337993.0  374534.2  305472.6  758880.7  398586.5  782366.0 1053463.7  #>       S01       S02       S03       S04       S05       S06  #>  257089.8  416672.4  301026.8  420146.3  342398.1  536383.0    # ================================================================ # Example 2: Two-stage Complex Design # ================================================================  # PSU = municipality, Strata = NUTS2, weights = weight, y = eq_income  # Define a weighted mean estimator wmean_estimator <- function(y, weights) {   sum(y * weights, na.rm = TRUE) / sum(weights, na.rm = TRUE) }  boot_complex <- rescaled_bootstrap(   data = synthouse,   y = \"eq_income\",   strata = \"NUTS2\",   psu = \"municipality\",   weights = \"weight\",   estimator = wmean_estimator,   by_strata = TRUE,   B = 50,   seed = 456 ) #>    |                                                                               |                                                                      |   0%   |                                                                               |=                                                                     |   2%   |                                                                               |===                                                                   |   4%   |                                                                               |====                                                                  |   6%   |                                                                               |======                                                                |   8%   |                                                                               |=======                                                               |  10%   |                                                                               |========                                                              |  12%   |                                                                               |==========                                                            |  14%   |                                                                               |===========                                                           |  16%   |                                                                               |=============                                                         |  18%   |                                                                               |==============                                                        |  20%   |                                                                               |===============                                                       |  22%   |                                                                               |=================                                                     |  24%   |                                                                               |==================                                                    |  26%   |                                                                               |====================                                                  |  28%   |                                                                               |=====================                                                 |  30%   |                                                                               |======================                                                |  32%   |                                                                               |========================                                              |  34%   |                                                                               |=========================                                             |  36%   |                                                                               |===========================                                           |  38%   |                                                                               |============================                                          |  40%   |                                                                               |=============================                                         |  42%   |                                                                               |===============================                                       |  44%   |                                                                               |================================                                      |  46%   |                                                                               |==================================                                    |  48%   |                                                                               |===================================                                   |  50%   |                                                                               |====================================                                  |  52%   |                                                                               |======================================                                |  54%   |                                                                               |=======================================                               |  56%   |                                                                               |=========================================                             |  58%   |                                                                               |==========================================                            |  60%   |                                                                               |===========================================                           |  62%   |                                                                               |=============================================                         |  64%   |                                                                               |==============================================                        |  66%   |                                                                               |================================================                      |  68%   |                                                                               |=================================================                     |  70%   |                                                                               |==================================================                    |  72%   |                                                                               |====================================================                  |  74%   |                                                                               |=====================================================                 |  76%   |                                                                               |=======================================================               |  78%   |                                                                               |========================================================              |  80%   |                                                                               |=========================================================             |  82%   |                                                                               |===========================================================           |  84%   |                                                                               |============================================================          |  86%   |                                                                               |==============================================================        |  88%   |                                                                               |===============================================================       |  90%   |                                                                               |================================================================      |  92%   |                                                                               |==================================================================    |  94%   |                                                                               |===================================================================   |  96%   |                                                                               |===================================================================== |  98%   |                                                                               |======================================================================| 100%  # Display variance and bootstrap estimates summary(boot_complex$variance) #>     Min.  1st Qu.   Median     Mean  3rd Qu.     Max.  #>   677932  1868471  2541061  3578920  4590571 10589595   # Strata and PSU summary boot_complex$strata_info #>      stratum n_psu m_psu #> C01      C01    36    33 #> C02      C02    36    33 #> C03      C03    36    33 #> C04      C04    36    33 #> C05      C05    36    33 #> C06      C06    36    33 #> N01      N01    36    33 #> N02      N02    36    33 #> N03      N03    36    33 #> N04      N04    36    33 #> N05      N05    36    33 #> N06      N06    36    33 #> NE01    NE01    36    33 #> NE02    NE02    36    33 #> NE03    NE03    36    33 #> NE04    NE04    36    33 #> NE05    NE05    36    33 #> NE06    NE06    36    33 #> NO01    NO01    36    33 #> NO02    NO02    36    33 #> NO03    NO03    35    32 #> NO04    NO04    36    33 #> NO05    NO05    36    33 #> NO06    NO06    36    33 #> S01      S01    36    33 #> S02      S02    36    33 #> S03      S03    36    33 #> S04      S04    36    33 #> S05      S05    36    33 #> S06      S06    36    33 # }   # ================================================================ # Note: # These examples use small B for speed. For actual analysis, # use B >= 200 for stable estimates. # ================================================================"},{"path":"/reference/superpop_qri.html","id":null,"dir":"Reference","previous_headings":"","what":"Quantile Ratio Index Estimator in Superpopulation ‚Äî superpop_qri","title":"Quantile Ratio Index Estimator in Superpopulation ‚Äî superpop_qri","text":"Computes theoretical quantile ratio index (QRI) measuring inequality given parametric distribution.","code":""},{"path":"/reference/superpop_qri.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Quantile Ratio Index Estimator in Superpopulation ‚Äî superpop_qri","text":"","code":"superpop_qri(qfunction, lower = 0, upper = 1, subdivisions = 1000L, ...)"},{"path":"/reference/superpop_qri.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Quantile Ratio Index Estimator in Superpopulation ‚Äî superpop_qri","text":"qfunction quantile function (e.g., qnorm, qlnorm, qgamma). lower Lower bound integration. Default 0. upper Upper bound integration. Default 1. subdivisions Maximum number subintervals integration. Default 1000L. ... Additional parameters pass qfunction (e.g., distribution parameters).","code":""},{"path":"/reference/superpop_qri.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Quantile Ratio Index Estimator in Superpopulation ‚Äî superpop_qri","text":"numeric value representing theoretical QRI specified parametric distribution. Values range 0 (perfect equality) 1 (maximum inequality).#'","code":""},{"path":"/reference/superpop_qri.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Quantile Ratio Index Estimator in Superpopulation ‚Äî superpop_qri","text":"QRI proposed (Prendergast Staudte 2018)  fot economic inequality measurement. calculated : $$QRI = 1 - \\int_0^1 R(p) dp$$ \\(R(p) = Q(p/2) / Q(1 - p/2)\\) ratio symmetric quantiles function. function computes (superpopulation) QRI theoretical parametric distributions, opposed qri estimates QRI sample data.","code":""},{"path":"/reference/superpop_qri.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Quantile Ratio Index Estimator in Superpopulation ‚Äî superpop_qri","text":"Prendergast LA, Staudte RG (2018). ‚Äúsimple effective inequality measure.‚Äù American Statistician, 72, 328‚Äì343.","code":""},{"path":[]},{"path":"/reference/superpop_qri.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Quantile Ratio Index Estimator in Superpopulation ‚Äî superpop_qri","text":"","code":"# Log-normal distribution superpop_qri(qlnorm, meanlog = 9, sdlog = 0.3) #> [1] 0.3433188 superpop_qri(qlnorm, meanlog = 9, sdlog = 1.4) #> [1] 0.7424406  # Weibull distribution superpop_qri(qweibull, shape = 1.7, scale = 30000) #> [1] 0.5669101 superpop_qri(qweibull, shape = 1.7, scale = 30000) #> [1] 0.5669101"},{"path":"/reference/synthouse.html","id":null,"dir":"Reference","previous_headings":"","what":"Synthetic Household Survey Data ‚Äî synthouse","title":"Synthetic Household Survey Data ‚Äî synthouse","text":"realistic synthetic dataset based empirical structure real -SILC (Italian Survey Income Living Conditions) 2024 data. synthouse dataset contains 20,034 individuals nested 10,099 households, detailed demographic, socio-economic, geographic information.","code":""},{"path":"/reference/synthouse.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Synthetic Household Survey Data ‚Äî synthouse","text":"","code":"synthouse"},{"path":"/reference/synthouse.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Synthetic Household Survey Data ‚Äî synthouse","text":"data frame 20,034 rows (individuals), 10,099 households 15 variables: person_id Character. Unique person identifier (format: P00000001, P00000002, ...) hh_id Character. Household identifier. individuals household share ID (format: HH000001, HH000002, ...) NUTS1 Character. NUTS1 region code (5 macro-regions): N S NE C NUTS2 Character. NUTS2 region code (30 regions, format: N01-N06, S01-S06, ...) NUTS3 Character. NUTS3 province code (120 provinces, format: N01001-N01004, ...) municipality Character. Municipality code (1,079 municipalities, format: N010010001-N010010008, ...) age Integer. Age years (0-80) age_class Factor. Age class 7 levels: \"0-14\", \"15-17\", \"18-24\", \"25-34\", \"35-49\", \"50-64\", \"65+\" gender Integer. Gender code: 1 = Male 2 = Female education_level Character. Education level (adults 18+ , NA minors): \"Low\" = education, primary, lower secondary (ISCED 0-2) \"Medium\" = Upper secondary post-secondary non-tertiary (ISCED 3-5) \"High\" = Tertiary education (ISCED 6-8) employment_status Character. Main activity status: \"Employed\" = employment \"Unemployed\" = Unemployed \"Retired\" = Retired \"Student\" = Student pupil \"\" = (unable work, domestic tasks, etc.) hh_size Integer. Household size (number members): 1-7 hh_type Character. Household type: \"Single\" = One-person household \"Couple\" = Two adults without children \"Single_parent\" = Single parent children \"Family\" = Household children (2+ adults) \"\" = household types eq_income Numeric. Equivalised disposable household income euros. total household income divided OECD modified equivalence scale. household members share equivalised income. hh_income Numeric. Total disposable household income euros equivalisation. household members share total income. oecd_scale Numeric. OECD modified equivalence scale household: First adult (14+): weight = 1.0 adults (14+): weight = 0.5 Children (< 14): weight = 0.3 Formula: modif_oecd_scale = 1.0 + 0.5 √ó (n_adults - 1) + 0.3 √ó n_children weight Numeric. Sampling weight (inverse inclusion probability). Represents number individuals population represented sample unit. household members share weight.","code":""},{"path":"/reference/synthouse.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Synthetic Household Survey Data ‚Äî synthouse","text":"synthetic dataset generated reproduce key characteristics -SILC data. primarily intended demonstrate computation quantile-based inequality indicators provided inequantiles package, quantiles, influence functions, quantile ratio index (QRI). data structure mirrors -SILC contains fictional values, therefore suitable methodology illustration testing, policy analysis. Geographic variables follow hierarchical NUTS structure realistic proportions across macro-regions created randomly, correspond real codes. Individual characteristics (age, gender, education, ..) assigned randomly based conditional empirical distributions -SILC. Income generated using regression model fitted -SILC data: $$log(eq_income) ~ education_head + n_employed + age_head +           (age_head^2) + hh_size$$. Sampling weights follow lognormal distribution fitted -SILC. Key Statistics: Sample size: 20,034 individuals 10,099 households Average household size: ~1.99 (matching -SILC) Estimated population: 15,749,925 individuals (sum weights) Geographic coverage: 5 macro-regions, 30 NUTS2, 120 NUTS3, 1,079 municipalities","code":""},{"path":"/reference/synthouse.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Synthetic Household Survey Data ‚Äî synthouse","text":"Eurostat (2024). \"EU Statistics Income Living Conditions (EU-SILC) methodology\". https://ec.europa.eu/eurostat/","code":""},{"path":"/reference/synthouse.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Synthetic Household Survey Data ‚Äî synthouse","text":"","code":"# Load the dataset data(synthouse)  # Basic structure str(synthouse) #> tibble [20,034 √ó 17] (S3: tbl_df/tbl/data.frame) #>  $ person_id        : chr [1:20034] \"HH000001P1\" \"HH000001P2\" \"HH000001P3\" \"HH000001P4\" ... #>  $ hh_id            : chr [1:20034] \"HH000001\" \"HH000001\" \"HH000001\" \"HH000001\" ... #>  $ NUTS1            : chr [1:20034] \"N\" \"N\" \"N\" \"N\" ... #>  $ NUTS2            : chr [1:20034] \"N01\" \"N01\" \"N01\" \"N01\" ... #>  $ NUTS3            : chr [1:20034] \"N01005\" \"N01005\" \"N01005\" \"N01005\" ... #>  $ municipality     : chr [1:20034] \"N010050010\" \"N010050010\" \"N010050010\" \"N010050010\" ... #>  $ age              : num [1:20034] 39 38 15 13 37 54 55 61 56 69 ... #>  $ age_class        : Factor w/ 7 levels \"0-14\",\"15-17\",..: 5 5 2 1 5 6 6 6 6 7 ... #>  $ gender           : num [1:20034] 1 2 1 2 2 2 1 2 1 1 ... #>  $ education_level  : chr [1:20034] \"Low\" \"Medium\" NA NA ... #>  $ employment_status: chr [1:20034] \"Employed\" \"Employed\" \"Student\" \"Student\" ... #>  $ hh_size          : int [1:20034] 4 4 4 4 1 2 2 2 2 2 ... #>  $ hh_type          : chr [1:20034] \"Family\" \"Family\" \"Family\" \"Family\" ... #>  $ eq_income        : num [1:20034] 10431 10431 10431 10431 36588 ... #>  $ hh_income        : num [1:20034] 23991 23991 23991 23991 36588 ... #>  $ oecd_scale       : num [1:20034] 2.3 2.3 2.3 2.3 1 1.5 1.5 1.5 1.5 1.5 ... #>  $ weight           : num [1:20034] 83.7 83.7 83.7 83.7 167.2 ... head(synthouse) #> # A tibble: 6 √ó 17 #>   person_id  hh_id    NUTS1 NUTS2 NUTS3   municipality   age age_class gender #>   <chr>      <chr>    <chr> <chr> <chr>   <chr>        <dbl> <fct>      <dbl> #> 1 HH000001P1 HH000001 N     N01   N01005  N010050010      39 35-49          1 #> 2 HH000001P2 HH000001 N     N01   N01005  N010050010      38 35-49          2 #> 3 HH000001P3 HH000001 N     N01   N01005  N010050010      15 15-17          1 #> 4 HH000001P4 HH000001 N     N01   N01005  N010050010      13 0-14           2 #> 5 HH000002P1 HH000002 NE    NE06  NE06004 NE060040007     37 35-49          2 #> 6 HH000003P1 HH000003 N     N05   N05003  N050030007      54 50-64          2 #> # ‚Ñπ 8 more variables: education_level <chr>, employment_status <chr>, #> #   hh_size <int>, hh_type <chr>, eq_income <dbl>, hh_income <dbl>, #> #   oecd_scale <dbl>, weight <dbl>  # Summary statistics summary(synthouse$eq_income) #>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.  #>    1523   12912   20429   25791   32529  298003  summary(synthouse$age) #>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.  #>    0.00   36.00   45.00   45.98   63.00   85.00   # Number of households and individuals length(unique(synthouse$hh_id))  # Households #> [1] 10099 nrow(synthouse)                  # Individuals #> [1] 20034  # Average household size mean(table(synthouse$hh_id)) #> [1] 1.983761  # Distribution of household types table(unique(synthouse[, c(\"hh_id\", \"hh_type\")])$hh_type) #>  #>        Couple        Family         Other        Single Single_parent  #>          2910          1537          1161          4329           162   # Age distribution table(synthouse$age_class) #>  #>  0-14 15-17 18-24 25-34 35-49 50-64   65+  #>  2011   557    47  1779  8291  2504  4845    # Weighted quantiles csquantile(synthouse$eq_income,            weights = synthouse$weight,            probs = c(0.25, 0.5, 0.75),            type = 6) #>      25%      50%      75%  #> 12353.29 20014.17 32222.93   # Quantile Ratio Index qri(synthouse$eq_income,     weights = synthouse$weight,     type = 6) #> [1] 0.5690895"}]
